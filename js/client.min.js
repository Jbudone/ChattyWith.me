var settings=function(){var a={message_maxlen:512,pingTimer:750,pingTimeout:3e3,longpollRetry:750,longpollTimeout:8e3,colourMap:["white","","navy","green","red","maroon","purple","olive","orange","lime","teal","aqua","royalBlue","fuchsia","grey","silver"],emoticonMap:{"\\:DD":"grin.gif","\\(H\\)":"cool.gif","\\:S":"confused2.gif","\\:D":"open-smile.gif","\\:P":"tongue.gif","\\(Y\\)":"thumbs-up.gif","\\(N\\)":"thumbs-down.gif","\\(BD\\)":"nerd.gif","\\(\\=\\\\\\)":"mouth-at-side.gif","\\(\\=\\/\\)":"mouth-at-side.gif","\\:X":"lips-are-sealed.gif","\\:\\$":"embarrassed.gif","\\(\\:\\(":"sad.gif","\\:\\(\\(":"depressed.gif","\\:\\(":"frown.gif","\\:\\'\\(":"crying.gif","0\\:\\)":"angelic.gif","\\:\\)":"happy.gif","\\^o\\)":"not-sure.gif","\\+o\\(":"being-sick.gif","\\(8\\)":"music.png","\\(Y\\)":"sleepy.gif",'\\:\\"\\(':"crying2.gif","\\(BD2\\)":"dork.gif","\\+oP":"ill.gif","\\:R":"tongue2.gif","\\(hubba\\)":"hubba_hubba.gif","\\(laugh\\)":"laugh.gif","\\(\\:\\(":"sad.gif","\\(BH\\)":"cool2.gif",'\\:\\"D':"crying_with_laughter.gif","\\(0o\\)":"black_eye.gif","\\;\\)":"wink.gif","\\;S":"confused.gif","\\:\\@":"angry.gif","\\:Z":"zip.gif","\\:O":"surprised.gif","\\(L\\)":"heart.png","\\(der\\)":"caveman.gif"},messages:{loaded:{chanid:0,type:"startup",messages:["Welcome to ^8ChattyWith.me ^14!!!,","^14  An AJAX approach to IRC"," "]},loaded_mobile:{chanid:0,type:"startup",messages:["Welcome to ^8ChattyWith.me ^14!!!,","^14  An AJAX approach to IRC","^15  The ^0mobile^15 edition"," "]},loaded_loggedout:{chanid:0,type:"startup",messages:["Now that ^8ChattyWith^15.^8me ^1has loaded","\tyou may pick a nickname to start chatting by. Type ^0/nick ^15[^9username^15] ^1to choose your username.","\texample, ^0/nick ^9superman","\tor perhaps ^0/nick ^9leeroyjenkins"]},loaded_loggedout_mobile:{chanid:0,type:"startup",messages:["Now that ^8ChattyWith^15.^8me ^11has loaded","Pick a nickname to start chatting, like this: ^0/nick ^15[^9username^15] ^1to choose your username.","  example, ^0/nick ^9superman","  or perhaps ^0/nick ^9leeroyjenkins"]},logon:{chanid:0,type:"startup",messages:["Now that you have logged in it is time to start chatting","Type the following to join the room called 'lolfun': ^0/join ^9#lolfun","Or otherwise, click the list icon on the right to display a list of all public chatrooms","Have fun, stay a while and make some friends."," "," ","\tAuthor: ^0JB Braendel","   You can find me on,","   ^15Portal^1: http://jbud.me","   ^15Twitter^1: https://twitter.com/#!/thatsjb","   ^15Facebook^1: http://www.facebook.com/jb.braendel","   ^15Github^1: https://github.com/Jbudone/ChattyWith.me"," ","Thanks go out to: ^0jQuery^1, ^0LESS","Beautiful Background from: http://fullhdwallpapers.info/abstract/colorful-abstract-wallpaper-2/"]},logon_mobile:{chanid:0,type:"startup",messages:[" ","Now that you have logged in it is time to start chatting","Type the following to join the room called 'lolfun': ^0/join ^9#lolfun","Have fun, stay a while and make some friends."," "," ","\tAuthor: JB Braendel"," ","Thanks go out to: ^0jQuery^1, ^0jQuery-Mobile"," ","Supported Devices: ^0iOS3","Untested Devices: ^0iOS4+^1, ^0Android^1, ^0Blackberry^1, ^0Windows Phone^1, ^0Symbian"," "]}}};return a}();var client={lConsole:null,usrIdentification:null,usrNick:null,usrid:null,channels:{0:{channame:"server",chanid:0}},ignoreChannels:[],activeChanRef:null,initialize:function(){this.call_hook(this.hk_initialize_pre);this.activeChanRef=this.channels[0];lEvents=$("#_events");var a=document.createElement("script");a.defer=true;a.innerHTML=lEvents.html().slice(2,-2);a.innerHTML+=" client.initialize_finalize();";document.getElementsByTagName("head").item(0).appendChild(a);lEvents.remove()},initialize_finalize:function(){Events.Event[ECMD_JOIN].hooks.parsed=client.hevt_join_parse;Events.Event[ECMD_LEAVE].hooks.reqPre=client.hevt_leave_parse;Events.Event[ECMD_CHANOP].hooks.parsed=client.hevt_chanop_parse;Events.Event[ECMD_MESSAGE].hooks.parsed=client.hevt_message_parse;Events.Event[ECMD_ACTION].hooks.parsed=client.hevt_message_parse;Events.Event[ECMD_PINGCHAN].hooks.reqSuccess=function(){};Events.Event[ECMD_PINGCHAN].hooks.reqSuccessError=function(){};this.auto_ping();this.call_hook(this.hk_initialize_post)},getActiveChanID:function(){return this.activeChanRef==null?0:this.activeChanRef.chanid},getChanNameFromID:function(a){return this.channels[a]?this.channels[a].channame:""},longpoll:function(){this.call_hook(this.hk_longpoll_pre);var a=this.channels,b,c={};for(b in a){c[b]={chanid:b,maxmsgid:a[b].maxmsgid}}$.ajax({async:"true",cache:"false",dataType:"json",type:"GET",url:"system/longpolling.php",data:{channels:c,ignore:this.ignoreChannels,identification:this.usrIdentification},context:this,success:this._cblongpoll,error:this.hk_longpoll_error,timeout:settings.longpollTimeout});this.call_hook(this.hk_longpoll_post)},_cblongpoll:function(a){var b=false;if(a.channels){b=true;for(var c in a.channels){this.handle_messages(a.channels[c],c,false,false)}}else if(a.whispers){b=true;this.handle_whispers(a.whispers)}if(a.newchannels){for(var c in a.channels){if(typeof this.channels[c]!="undefined"){b=true;this.handle_messages(a.channels[c],c,false,false)}else if(this.ignoreChannels.indexOf(c)==-1)this.ignoreChannels.push(c)}}if(b)this.call_hook(this.hk_messagesreceived_post);if(this.usrIdentification)this.longpoll()},request:function(a){if(a.evtref==null){a.call_hook(hk_event_request_from_undefined_event);return false}try{if(a.evtref.hooks)a.call_hook(a.evtref.hooks.reqPre);var b={request:a.evtref.request,identification:this.usrIdentification};if(a.arguments)b.args=a.arguments;$.ajax({async:"true",cache:"false",dataType:"json",type:"GET",url:"system/requests.json.php",data:b,context:a,success:this.evt_handle_success,error:this.evt_handle_error});if(a.evtref.hooks)a.call_hook(a.evtref.hooks.reqPost)}catch(c){a.call_hook(hk_event_request_exception_thrown,c);return false}return true},auto_ping:function(){var a=[],b=0,c=null;for(b in client.channels){if(b==0)continue;a.push(b)}if(a.length==0){setTimeout(client.auto_ping,settings.pingTimer);return}c=(new Event).fromObject({eventid:"ECMD_PINGCHAN"});try{if(c.evtref.hooks)c.call_hook(c.evtref.hooks.reqPre);var d={request:"pingchan",identification:client.usrIdentification,args:{channels:a}};$.ajax({async:"true",cache:"false",dataType:"json",type:"GET",url:"system/requests.json.php",data:d,context:c,success:client.auto_ping_cb,error:client.auto_ping_err,timeout:settings.pingTimeout});if(c.evtref.hooks)c.call_hook(c.evtref.hooks.reqPost);c.args=d;c.args.sent=(new Date).getTime()}catch(e){c.call_hook(hk_event_request_exception_thrown,e);return false}},auto_ping_cb:function(a){if(a.response==2&&!(a.pinged=="0"&&this.args.args.channels.length>0)){var b=(new Date).getTime()-this.args.sent;this.call_hook(this.evtref.hooks.reqSuccess,b)}else{var c=function(){for(var a in client.channels){if(a==0)continue;(new Event).fromObject({eventid:"ECMD_JOIN",channelname:client.channels[a].channame}).request();delete client.channels[a];Terminal.removeChannel(a);Terminal.removeChannelWin(a)}Terminal.swapChannel(0,true);Terminal.scrollToBottom()};if(a.error){if(a.error==10){}else if(client.usrIdentification){var d=function(){$.ajax({async:"true",cache:"false",dataType:"json",type:"GET",url:"system/requests.json.php",data:{request:"identify",args:{id:client.usrIdentification}},context:this,success:function(a){console.log("Successful Response on Re-login request..");if(a.response==2){console.log("Silently Re-logged in");console.log("Attempting to rejoin channels after disconnect");c()}else d()},error:function(a){console.log("ERROR re-attemping login..trying again");d()},timeout:settings.pingTimeout});this.call_hook(this.evtref.hooks.reqSuccessError,b)};d();return}}else{if(a.pinged=="0"&&this.args.args.channels.length>0){console.log("Attempting to rejoin channels after disconnect");c()}}}setTimeout(client.auto_ping,settings.pingTimer)},auto_ping_err:function(a){this.call_hook(this.evtref.hooks.reqSuccessError,a);setTimeout(client.auto_ping,settings.pingTimer)},handle_whispers:function(a){var b=null,c=null,d=null;for(var e=0,b=a.length;e<b;e++){c=a[e];c.type="whisper";d=new Event;d.read(c,false);d.call_hook(hk_server_event_append_whisper);delete d}},handle_messages:function(a,b,c,d){this.call_hook(hk_server_event_add_messages_started);var e=null,f=null,g=null,h=null,i=null,j=null;e=this.channels[b];if(typeof e!="undefined"){h=this.getChanNameFromID(b);for(i=0,msgLength=a.length;i<msgLength;i++){f=a[i];if(f.id>e.maxmsgid){e.maxmsgid=f.id;if(e.minmsgid==null)e.minmsgid=f.id}else if(c==true&&f.id<e.minmsgid)e.minmsgid=f.id;else continue;f.chanid=b;f.channame=h;f.old=c;g=new Event;g.read(f,c);if(d)g.call_hook(hk_server_event_prepend_message);else g.call_hook(hk_server_event_append_message);delete g}}this.call_hook(hk_server_event_add_messages_completed)},handle_evtMessage:function(a){var b=a["message"],c=a["type"],d=a["data"];var e=b.split("\\n"),f=function(a){a=a.slice(1);if(d[a])return d[a];return""};for(var g=0;g<e.length;g++){e[g]=e[g].replace(/(%\w+)/g,f)}if(d.error){try{var h="";h=errCodes[d.error].message.replace(/(%\w+)/g,f);d.errMsg=h;for(g=0;g<e.length;g++){e[g]=e[g].replace(/\$ERRMSG/gi,h);e[g]=e[g].replace(/\$ERRID/gi,d.error)}}catch(i){d.errMsg=""}}for(g=0;g<e.length;g++){this.call_hook(hk_server_event_append_log,{message:e[g],type:c})}},evt_handle_success:function(a){if(a&&a.response==2){if(this.evtref.hSuccess)this.call_hook(this.evtref.hSuccess,a);if(this.evtref.hooks)this.call_hook(this.evtref.hooks.reqSuccess,a);_callSuccessMessage=true;if(this.cb_success)_callSuccessMessage=this.cb_success.call(this.cb_success_context,a);if(_callSuccessMessage&&this.evtref.mSuccess)client.handle_evtMessage.call(this,{data:a,message:this.evtref.mSuccess,type:"success"})}else{if(typeof a.error!="undefined")this.call_hook(hk_server_response_error,errCodes[a.error]);if(this.evtref.hooks)this.call_hook(this.evtref.hooks.reqSuccessError,a);if(this.evtref.mError)client.handle_evtMessage.call(this,{data:a,message:this.evtref.mError,type:"error"})}},evt_handle_error:function(a,b,c){this.request()},hevt_chanop_parse:function(){var a=this.arguments.optype;if(a.match(/^(\+o|chanop|ops|op|operator|\+op|chanops|owner|chanowner|\+owner|\+chanowner|o|\+ops)$/i)){a="0"}else if(a.match(/^(\+v|voice|chanvoice|v|\+voice)$/i)){a="1"}else a="2";this.arguments.optype=a},hevt_message_parse:function(){this.arguments["message"]=encodeURIComponent(this.arguments["message"])},hevt_join_parse:function(){if(this.arguments["channelname"][0]=="#"){this.arguments["channelname"]=this.arguments["channelname"].slice(1);return this.arguments["channelname"]!==""}},hevt_leave_parse:function(){this.arguments["chanid"]=client.activeChanRef.chanid},hevt_login:function(a,b){client.usrNick=b.nick;client.usrIdentification=b.identification;client.usrid=b.userid;client.longpoll();localStorage.setItem("identification",b.identification)},hevt_logout:function(a,b){client.usrIdentification=null;client.usrid=null;Terminal.swapChannel(0,true);Terminal.removeChannels();Terminal.removeChannelWins();Terminal.scrollToBottom();client.channels={0:client.channels[0]};localStorage.removeItem("identification")},hevt_join:function(a,b){b=b.channel;client.channels[b.chanid]={};var c=client.channels[b.chanid];c.settings={};c.users={};c.chanid=b.chanid;c.channame=b.title;c.maxmsgid=0;c.minmsgid=null;c.settings.topic=b.topic;c.settings.private=b.private=="1"?true:false;c.settings.moderated=b.moderated=="1"?true:false;c.settings.autoclear=b.autoclear=="1"?true:false;var d=null,e=null,f=null;for(var g in b.users){d=b.users[g];f=d.id;c.users[f]={};e=c.users[f];e.userid=f;e.nick=d.nick;e.status=d.status}client.handle_messages(b.messages,b.chanid,true,false);Terminal.openChannelWin(b.title,b.chanid);Terminal.swapChannel(b.chanid,false);Terminal.scrollToBottom()},hevt_leave:function(a,b){Terminal.swapChannel(getChanIDFromOffset(-1),true);delete client.channels[b.chanid];Terminal.removeChannel(b.chanid);Terminal.removeChannelWin(b.chanid);Terminal.scrollToBottom()},hevt_retrieveold:function(a,b){b.messages.reverse();client.handle_messages(b.messages,b.chanid,true,true)},hevt_whisper:function(a,b){a.arguments.timestamp=a.timestamp;Terminal.print_whisper(a.arguments,false);Terminal.scrollToBottom()},hsrv_join:function(){this.call_hook(client.hk_user_joined_pre,this.arguments);var a=this.arguments.chanid;var b=client.channels[a];if(typeof b=="undefined")return;var c=b.users[this.arguments.suserid]={};c.userid=this.arguments.suserid;c.nick=this.arguments.susernick;c.status=null;this.call_hook(client.hk_user_joined_post,this.arguments)},hsrv_leave:function(){this.call_hook(client.hk_user_left_pre,this.arguments);var a=this.arguments.chanid;var b=client.channels[a];if(typeof b=="undefined")return;if(this.arguments.duserid==client.usrid){client.hevt_leave.apply(this,new Array(this,this.arguments));return}delete b.users[this.arguments.duserid];this.call_hook(client.hk_user_left_post,this.arguments)},hsrv_modify_ops:function(){this.call_hook(client.hk_user_changed_pre,this.arguments);var a=this.arguments.chanid;var b=client.channels[a];if(typeof b=="undefined")return;var c=b.users[this.arguments.duserid];if(typeof c=="undefined")return;c.status=this.evtref._eventid==ESRV_SETOPS_CHANOPS_ON?"operator":this.evtref._eventid==ESRV_SETOPS_VOICE_ON?"voice":"";this.arguments.status=c.status;this.call_hook(client.hk_user_changed_post,this.arguments)},hsrv_modify_chan:function(){this.call_hook(client.hk_channel_changed_pre,this.arguments);var a=this.arguments.chanid;var b=client.channels[a];if(typeof b=="undefined")return;if(this.evtid==ESRV_MODIFY_TOPIC)b.settings.topic=this.arguments.topic;else if(this.evtid==ESRV_MODIFY_MODERATED_ON)b.settings.moderated=true;else if(this.evtid==ESRV_MODIFY_MODERATED_OFF)b.settings.moderated=false;else if(this.evtid==ESRV_MODIFY_PRIVATE_ON)b.settings.private=true;else if(this.evtid==ESRV_MODIFY_PRIVATE_OFF)b.settings.private=false;else if(this.evtid==ESRV_MODIFY_AUTOCLEAR_ON)b.settings.autoclear=true;else if(this.evtid==ESRV_MODIFY_AUTOCLEAR_OFF)b.settings.autoclear=false;this.call_hook(client.hk_channel_changed_post,this.arguments)},call_hook:function(a){if(typeof a=="function")a.call(this)},hk_initialize_pre:null,hk_initialize_post:null,hk_longpoll_pre:null,hk_longpoll_post:null,hk_longpoll_error:function(a){setTimeout(function(){client.longpoll.apply(client)},settings.longpollRetry)},hk_messagesreceived_post:null,hk_user_left_pre:null,hk_user_left_post:null,hk_user_joined_pre:null,hk_user_joined_post:null,hk_user_changed_pre:null,hk_user_changed_post:null,hk_channel_changed_pre:null,hk_channel_changed_post:null,_tMessageCreated:null};var Event=function(){this.eventid=0;this.evtref=null;this.timestamp=Date.now();this.client=client;this.fromObject=function(a){this.arguments={};for(var b in a){this[b]=a[b];this.arguments[b]=a[b]}if(a.eventid)this.evtref=Events.Event[a.eventid];return this};this.read=function(a,b){try{this.arguments={};for(var c in a){this.arguments[c]=a[c]}if(a.type=="event"){var d=a.message.match(/^\S+/);if(d.length==1){d=d[0];this.evtref=Events.ServerEvent[d];if(this.evtref!=undefined){var e=this.evtref.parseFormat;var f="^\\S+";var g=e.length;var h;for(h=0;h<g;h++){f+="(?:\\s+("+(h+1==g?".+":"\\S+")+"))?"}var i=a.message.match(f);i.shift();for(h=0;h<i.length;h++){this.arguments[this.evtref.parseFormat[h]]=i[h]}var j=this.arguments;this.arguments.message=this.evtref.message.replace(/(%\w+)/g,function(a){a=a.slice(1);if(j[a])return j[a];return""});if(!b){this.call_hook(this.evtref.handler)}}else hk_server_event_from_undefined_event()}else hk_server_event_from_undefined_event()}}catch(k){this.call_hook(hk_server_event_exception_thrown,k)}return this};this.parse=function(a){var b=a.match(/^\/(\S*)/);if(b&&b.length>=2){b=b[1];if(this.eventid=Events.getCommandID(b)){this.evtref=Events.Event[this.eventid];this.arguments={};var c;if(c=this.evtref.parseFormat){var d="^\\/\\S+";var e=c.length;var f;for(f=0;f<e;f++){if(c[f].value)continue;d+="(?:\\s+("+(f+1==e&&c[f].continuous?".+":"\\S+")+(c[f].optional?"))?":"))")}var g=a.match(d);if(g){g.shift();for(f=0;f<g.length;f++){if(typeof g[f]=="undefined")continue;this[c[f].name]=g[f];this.arguments[c[f].name]=g[f]}for(f=0;f<e;f++){if(c[f].value){this[c[f].name]=c[f].value;this.arguments[c[f].name]=c[f].value}}if(this.evtref.flags&EFLG_APPENDCHANID){var h=client.getActiveChanID();this["chanid"]=h;this.arguments["chanid"]=h}if(this.call_hook(this.evtref.hooks.parsed)==false){this.call_hook(hk_event_parsed_bad_format,{string:a,command:b,event:this.evtref});return false}if(this.evtref.flags&EFLG_EXECUTE)this.execute()}else{this.call_hook(hk_event_parsed_bad_format,{string:a,command:b,event:this.evtref});return false}}}else{this.call_hook(hk_event_unknown_command,a);return false}}else if(a.length>0){return this.parse("/message "+a)}return this};this.execute=function(){this.call_hook(this.evtref.hSuccess);return this};this.request=function(a){if(a){this.cb_success=a;this.cb_success_context=arguments.callee}this.client.request(this);return this};this.hook_context=this;this.call_hook=function(a,b){if(typeof a=="function")return a.call(this.hook_context,this,b);return true};return this};var Message=function(a,b,c,d,e,f){var g=$("<span/>").addClass("chanitem").addClass("chanid-"+a),h=$("<span/>").addClass("msg-message").appendTo(g),i=Message.prototype.getClassesFromType(c);var j=function(a){a=a.replace(/</g,"<").replace(/>/g,">");return a},k=function(a,b){if(a&&b){for(var c=0;c<b.length;c++){a.addClass(b[c])}}},l=function(a){var b=settings.colourMap;a=a.replace(/\^(1[0-5]|[0-9])/g,function(a){return"<a style='color: "+b[arguments[1]]+"'>"});a=a+"</a>";return a},m=function(a){var b=settings.emoticonMap;for(var c in b){var d=new RegExp(c,"gi");a=a.replace(d,'<img class="emoticon" src="images/emoticons/'+b[c]+'" />')}return a},n=function(a){a=a.replace(/((https?:\/\/|(www\.))([\da-z\-\Q_.\E]+\.[a-z]+[a-z\d\-\Q_!.?=&%#*\/\E]*))/gi,"<a href='http://$3$4' target='_blank'>$1</a>");return a};k(g,i.container);k(h,i.message);if(e){var o=$("<span/>").addClass("msg-user").prependTo(g);if(c.match(/action/))o.text("*"+e+" ");else if(c.match(/whisper/))o.text("-"+e+"-");else if(c.match(/event/))o.text("");else o.text(e+" says: ");k(o,i.user)}if(d){var p=new Date(d.replace(/-/g,"/")),q=isNaN(p.getSeconds())?new Date(d):p,r,s,t;r=q.getSeconds();if((""+r).length==1)r="0"+r;s=q.getMinutes();if((""+s).length==1)s="0"+s;t=q.getHours();if(t>12)t-=12;d=""+t+":"+s+":"+r+"  ";var u=$("<span/>").addClass("msg-time").text(d).prependTo(g);k(u,i.time)}if(!f&&b){b=n(m(l(j(b))))}h.html(b);return g};var Terminal=function(){var a={print:null,print_0:null,print_all:null,print_preset:null,print_message:null,print_whisper:null,scrollToBottom:null,swapChannel:null,removeChannel:null,removeChannels:null,resizePage:null,openChannel:null,hk_swapChannel_pre:null,hk_swapChannel_post:null,loadOlder:null};(function(){a.print=function(a,b,c,d,e,f,g){var h=new Message(a,b,c,d,e,g);if(f)h.prependTo("#console");else h.appendTo("#console")};a.print_all=function(b,c,d,e,f,g){for(var h in client.channels){a.print(client.channels[h].chanid,b,c,d,e,f,g)}};a.print_0=function(b,c,d,e,f,g){a.print(0,b,c,d,e,f,g)};a.print_preset=function(b){var c=settings.messages[b],d,e;if(!c)throw new Error("Could not find settings.message["+b+"]");e=c.messages.length;for(d=0;d<e;d++){if(c.chanid==0)a.print(0,c.messages[d],c.type);else a.print(client.activeChanRef.chanid,c.messages[d],c.type)}};a.print_message=function(b,c,d,e){if(b==null){for(var f in client.channels){a.print_message(client.channels[f].chanid,c,d,e)}return}if(c.userid==client.usrid)c.type="self-"+c.type;if(c.old==true)c.type="old-"+c.type;var g=new Message(b,c.message,c.type,c.timestamp,c.nick,e);if(d)g.prependTo("#console");else g.appendTo("#console")};a.print_whisper=function(a,b){var c=new Date(a.timestamp),d="whisper";for(var e in client.channels){var f=new Message(e,a.message,d,c.toString(),a.nick);f.appendTo("#console")}};a.swapChannel=function(b,c){if(typeof a.hk_swapChannel_pre=="function")a.hk_swapChannel_pre.apply(this,[b,c]);client.activeChanRef=client.channels[b];try{var d=document.getElementById("styleChanDisplay");d.innerHTML=".chanitem { display:block; } #console .chanitem:not(.chanid-"+b+") { display:none !important; } ";document.getElementsByTagName("head").item(0).removeChild(d);document.getElementsByTagName("head").item(0).appendChild(d)}catch(e){$("#console").css({display:"none"});$(".chanitem:not(.chanid-"+b+")").css({display:"none !important"});$(".chanid-"+b).css({display:"block !important"});$("#console").css({display:"block"})}try{var f=document.getElementById("chan-title");f.textContent=client.activeChanRef.channame}catch(e){}setTimeout(function(){a.resizePage();a.scrollToBottom(true)},200);if(typeof a.hk_swapChannel_post=="function")a.hk_swapChannel_post.apply(this,[b,c])};a.removeChannel=function(a){$(".chanid-"+a).remove()};a.removeChannels=function(){$(".chanitem:not(.chanid-0)").remove()};a.openChannelWin=function(){};a.closeChannelWin=function(){};a.scrollToBottom=function(){};a.resizePage=function(){};a.loadOlder=function(a){var b={load:null},c=a;b.load=function(a){if(c.activeChanRef.chanid==0)return;(new Event).fromObject({eventid:"ECMD_RETRIEVEOLD",maxmsgid:c.activeChanRef.minmsgid,chanid:c.activeChanRef.chanid}).request(a)};return b}(client)})();return a}()