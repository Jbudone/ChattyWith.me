var settings,client,Event,Message,Terminal;settings=function(){var e={message_maxlen:512,pingEnabled:!0,useLongpollPing:!0,pingTimer:750,pingTimeout:3e3,longpollRetry:750,longpollTimeout:4e4,minPingTimeoutsToDisconnect:10,maxTimeSinceLastPingToDisconnect:125e3,checkIfActiveTimer:100,colourMap:["white","","navy","green","red","maroon","purple","olive","orange","lime","teal","aqua","royalBlue","fuchsia","grey","silver"],emoticonMap:{"\\:DD":"grin.gif","\\(H\\)":"cool.gif","\\:S":"confused2.gif","\\:D":"open-smile.gif","\\:P":"tongue.gif","\\(Y\\)":"thumbs-up.gif","\\(N\\)":"thumbs-down.gif","\\(BD\\)":"nerd.gif","\\(\\=\\\\\\)":"mouth-at-side.gif","\\(\\=\\/\\)":"mouth-at-side.gif","\\:X":"lips-are-sealed.gif","\\:\\$":"embarrassed.gif","\\(\\:\\(":"sad.gif","\\:\\(\\(":"depressed.gif","\\:\\(":"frown.gif","\\:\\'\\(":"crying.gif","0\\:\\)":"angelic.gif","\\:\\)":"happy.gif","\\^o\\)":"not-sure.gif","\\+o\\(":"being-sick.gif","\\(8\\)":"music.png","\\(Y\\)":"sleepy.gif",'\\:\\"\\(':"crying2.gif","\\(BD2\\)":"dork.gif","\\+oP":"ill.gif","\\:R":"tongue2.gif","\\(hubba\\)":"hubba_hubba.gif","\\(laugh\\)":"laugh.gif","\\(\\:\\(":"sad.gif","\\(BH\\)":"cool2.gif",'\\:\\"D':"crying_with_laughter.gif","\\(0o\\)":"black_eye.gif","\\;\\)":"wink.gif","\\;S":"confused.gif","\\:\\@":"angry.gif","\\:Z":"zip.gif","\\:O":"surprised.gif","\\(L\\)":"heart.png","\\(der\\)":"caveman.gif"},messages:{loaded:{chanid:0,type:"startup",messages:["Welcome to ^8ChattyWith.me ^14!!!,","^14  An AJAX approach to IRC"," "]},loaded_mobile:{chanid:0,type:"startup",messages:["Welcome to ^8ChattyWith.me ^14!!!,","^14  An AJAX approach to IRC","^15  The ^0mobile^15 edition"," "]},loaded_loggedout:{chanid:0,type:"startup",messages:["Now that ^8ChattyWith^15.^8me ^1has loaded","	you may pick a nickname to start chatting by. Type ^0/nick ^15[^9username^15] ^1to choose your username.","	example, ^0/nick ^9superman","	or perhaps ^0/nick ^9leeroyjenkins"]},loaded_loggedout_mobile:{chanid:0,type:"startup",messages:["Now that ^8ChattyWith^15.^8me ^11has loaded","Pick a nickname to start chatting, like this: ^0/nick ^15[^9username^15] ^1to choose your username.","  example, ^0/nick ^9superman","  or perhaps ^0/nick ^9leeroyjenkins"]},logon:{chanid:0,type:"startup",messages:["Now that you have logged in it is time to start chatting","Type the following to join the room called 'lolfun': ^0/join ^9#lolfun","Or otherwise, click the list icon on the right to display a list of all public chatrooms","Have fun, stay a while and make some friends."," "," ","	Author: ^0JB Braendel","   You can find me on,","   ^15Portal^1: http://jbud.me","   ^15Twitter^1: https://twitter.com/#!/thatsjb","   ^15Facebook^1: http://www.facebook.com/jb.braendel","   ^15Github^1: https://github.com/Jbudone/ChattyWith.me"," ","Thanks go out to: ^0jQuery^1, ^0LESS","Beautiful Background from: http://fullhdwallpapers.info/abstract/colorful-abstract-wallpaper-2/"]},logon_mobile:{chanid:0,type:"startup",messages:[" ","Now that you have logged in it is time to start chatting","Type the following to join the room called 'lolfun': ^0/join ^9#lolfun","Have fun, stay a while and make some friends."," "," ","	Author: JB Braendel"," ","Thanks go out to: ^0jQuery^1, ^0jQuery-Mobile"," ","Supported Devices: ^0iOS3","Untested Devices: ^0iOS4+^1, ^0Android^1, ^0Blackberry^1, ^0Windows Phone^1, ^0Symbian"," "]}}};return e}(),client={lConsole:null,usrIdentification:null,usrNick:null,usrid:null,channels:{0:{channame:"server",chanid:0}},ignoreChannels:[],activeChanRef:null,initialReconnect:!1,initialize:function(){this.call_hook(this.hk_initialize_pre),this.activeChanRef=this.channels[0],lEvents=$("#_events");var e=document.createElement("script");e.defer=!0,e.innerHTML=lEvents.html().slice(2,-2),e.innerHTML+=" client.initialize_finalize();",document.getElementsByTagName("head").item(0).appendChild(e),lEvents.remove()},initialize_finalize:function(){Events.Event[ECMD_JOIN].hooks.parsed=client.hevt_join_parse,Events.Event[ECMD_LEAVE].hooks.reqPre=client.hevt_leave_parse,Events.Event[ECMD_CHANOP].hooks.parsed=client.hevt_chanop_parse,Events.Event[ECMD_MESSAGE].hooks.parsed=client.hevt_message_parse,Events.Event[ECMD_ACTION].hooks.parsed=client.hevt_message_parse,Events.Event[ECMD_PINGCHAN].hooks.reqSuccess=function(){},Events.Event[ECMD_PINGCHAN].hooks.reqSuccessError=function(){},this.auto_ping(),this.call_hook(this.hk_initialize_post)},getActiveChanID:function(){return this.activeChanRef==null?0:this.activeChanRef.chanid},getChanNameFromID:function(e){return this.channels[e]?this.channels[e].channame:""},longpoll:function(){this.call_hook(this.hk_longpoll_pre);var e,t=this.channels,n={};for(e in t)n[e]={chanid:e,maxmsgid:t[e].maxmsgid};getChanCount()>=2||this.initialReconnect&&!(this.initialReconnect=!this.initialReconnect)?($.ajax({async:"true",cache:"false",dataType:"json",type:"GET",url:"system/longpolling.php",data:{channels:n,ignore:this.ignoreChannels,identification:this.usrIdentification},context:this,success:this._cblongpoll,error:this._errlongpoll,timeout:settings.longpollTimeout}),this.call_hook(this.hk_longpoll_post)):setTimeout(function(){client.longpoll.apply(client)},settings.longpollRetry)},_errlongpoll:function(e,t,n){console.log("longpoll error.."),console.log(t),setTimeout(function(){client.longpoll.apply(client)},settings.longpollRetry),this.call_hook(this.hk_longpoll_error,this.arguments)},_cblongpoll:function(e){var t,n;if(this.call_hook(this.hk_longpoll_success,e),window.Terminal.hideBody(),t=!1,e.channels){t=!0;for(n in e.channels)this.handle_messages(e.channels[n],n,!1,!1)}else e.whispers&&(t=!0,this.handle_whispers(e.whispers));if(e.newchannels)for(n in e.newchannels)this.channels[n]!==void 0?(t=!0,this.handle_messages(e.newchannels[n],n,!1,!1)):this.hevt_join(null,e.newchannels[n]);t&&this.call_hook(this.hk_messagesreceived_post),this.usrIdentification&&this.longpoll(),window.Terminal.showBody()},request:function(t){if(t.evtref==null)return t.call_hook(hk_event_request_from_undefined_event),!1;try{t.evtref.hooks&&t.call_hook(t.evtref.hooks.reqPre);var n={request:t.evtref.request,identification:this.usrIdentification};t.arguments&&(n.args=t.arguments),$.ajax({async:"true",cache:"false",dataType:"json",type:"GET",url:"system/requests.json.php",data:n,context:t,success:this.evt_handle_success,error:this.evt_handle_error}),t.evtref.hooks&&t.call_hook(t.evtref.hooks.reqPost)}catch(s){return t.call_hook(hk_event_request_exception_thrown,s),!1}return!0},auto_ping:function(){var t,n,s,i;if(settings.pingEnabled&&!settings.useLongpollPing){t=[],n=0,s=null;for(n in client.channels)n!=0&&t.push(n);if(t.length==0)return window.console.log("auto_ping:: _channels.length==0"),setTimeout(client.auto_ping,settings.pingTimer),void 0;s=(new Event).fromObject({eventid:"ECMD_PINGCHAN"});try{s.evtref.hooks&&s.call_hook(s.evtref.hooks.reqPre),i={request:"pingchan",identification:client.usrIdentification,args:{channels:t}},$.ajax({async:"true",cache:"false",dataType:"json",type:"GET",url:"system/requests.json.php",data:i,context:s,success:client.auto_ping_cb,error:client.auto_ping_err,timeout:settings.pingTimeout}),s.evtref.hooks&&s.call_hook(s.evtref.hooks.reqPost),s.args=i,s.args.sent=(new Date).getTime()}catch(a){return s.call_hook(hk_event_request_exception_thrown,a),!1}}},auto_ping_cb:function(e){var t,n,s;if(e.response!=2||e.pinged=="0"&&0<this.args.args.channels.length)if(n=function(){for(var e in client.channels)e!=0&&((new Event).fromObject({eventid:"ECMD_JOIN",channelname:client.channels[e].channame}).request(),delete client.channels[e],Terminal.removeChannel(e),Terminal.removeChannelWin(e));Terminal.swapChannel(0,!0),Terminal.scrollToBottom()},e.error){if(window.console.log("auto_ping_cb:: data error,"),window.console.log(e.error),e.error==10);else if(client.usrIdentification)return s=function(){$.ajax({async:"true",cache:"false",dataType:"json",type:"GET",url:"system/requests.json.php",data:{request:"identify",args:{id:client.usrIdentification}},context:this,success:function(e){console.log("Successful Response on Re-login request.."),e.response==2?(console.log("Silently Re-logged in"),console.log("Attempting to rejoin channels after disconnect"),n()):s()},error:function(e){console.log("ERROR re-attemping login..trying again"),s()},timeout:settings.pingTimeout}),this.call_hook(this.evtref.hooks.reqSuccessError,t)},s(),void 0}else window.console.log("auto_ping_cb:: error without data.error"),e.pinged=="0"&&this.args.args.channels.length>0&&(console.log("Attempting to rejoin channels after disconnect"),n());else t=(new Date).getTime()-this.args.sent,this.call_hook(this.evtref.hooks.reqSuccess,t);setTimeout(client.auto_ping,settings.pingTimer)},auto_ping_err:function(e){window.console.log("auto_ping_err:: data error,"),window.console.log(e.error),this.call_hook(this.evtref.hooks.reqSuccessError,e),setTimeout(client.auto_ping,settings.pingTimer)},handle_whispers:function(e){var t,n,s,a;for(t=null,n=null,s=null,a=0,t=e.length;t>a;a++)n=e[a],n.type="whisper",s=new Event,s.read(n,!1),s.call_hook(hk_server_event_append_whisper),delete s},handle_messages:function(e,t,n,s){this.call_hook(hk_server_event_add_messages_started);var a=null,o=null,l=null,r=null,h=null;if(a=this.channels[t],a!==void 0)for(r=this.getChanNameFromID(t),h=0,msgLength=e.length;msgLength>h;h++){if(o=e[h],o.id>a.maxmsgid)a.maxmsgid=parseInt(o.id),a.minmsgid==null&&(a.minmsgid=parseInt(o.id));else{if(n!=1||o.id>=a.minmsgid)continue;a.minmsgid=parseInt(o.id)}o.chanid=t,o.channame=r,o.old=n,l=new Event,l.read(o,n),s?l.call_hook(hk_server_event_prepend_message):l.call_hook(hk_server_event_append_message),delete l}this.call_hook(hk_server_event_add_messages_completed)},handle_evtMessage:function(e){var t,n,s,a,o,l,r;for(t=e.message,n=e.type,s=e.data,a=t.split("\\n"),o=function(e){return e=e.slice(1),s[e]?s[e]:""},l=0;a.length>l;l++)a[l]=a[l].replace(/(%\w+)/g,o);if(s.error)try{for(r="",r=errCodes[s.error].message.replace(/(%\w+)/g,o),s.errMsg=r,l=0;a.length>l;l++)a[l]=a[l].replace(/\$ERRMSG/gi,r),a[l]=a[l].replace(/\$ERRID/gi,s.error)}catch(h){s.errMsg=""}for(l=0;a.length>l;l++)this.call_hook(hk_server_event_append_log,{message:a[l],type:n})},evt_handle_success:function(e){e&&e.response==2?(this.evtref.hSuccess&&this.call_hook(this.evtref.hSuccess,e),this.evtref.hooks&&this.call_hook(this.evtref.hooks.reqSuccess,e),_callSuccessMessage=!0,this.cb_success&&(_callSuccessMessage=this.cb_success.call(this.cb_success_context,e)),_callSuccessMessage&&this.evtref.mSuccess&&client.handle_evtMessage.call(this,{data:e,message:this.evtref.mSuccess,type:"success"})):(e.error!==void 0&&this.call_hook(hk_server_response_error,errCodes[e.error]),this.evtref.hooks&&this.call_hook(this.evtref.hooks.reqSuccessError,e),this.evtref.mError&&client.handle_evtMessage.call(this,{data:e,message:this.evtref.mError,type:"error"}))},evt_handle_error:function(e,t,n){this.request()},hevt_chanop_parse:function(){var e=this.arguments.optype;e=e.match(/^(\+o|chanop|ops|op|operator|\+op|chanops|owner|chanowner|\+owner|\+chanowner|o|\+ops)$/i)?"0":e.match(/^(\+v|voice|chanvoice|v|\+voice)$/i)?"1":"2",this.arguments.optype=e},hevt_message_parse:function(){this.arguments.message=encodeURIComponent(this.arguments.message)},hevt_join_parse:function(){return this.arguments.channelname[0]=="#"?(this.arguments.channelname=this.arguments.channelname.slice(1),this.arguments.channelname!==""):void 0},hevt_leave_parse:function(){this.arguments.chanid=client.activeChanRef.chanid},hevt_login:function(e,t){client.usrNick=t.nick,client.usrIdentification=t.identification,client.usrid=t.userid,client.initialReconnect=!0,client.longpoll(),localStorage.setItem("identification",t.identification)},hevt_logout:function(e,t){client.usrIdentification=null,client.usrid=null,Terminal.swapChannel(0,!0),Terminal.removeChannels(),Terminal.removeChannelWins(),Terminal.scrollToBottom(),client.channels={0:client.channels[0]},localStorage.removeItem("identification")},hevt_join:function(e,t){var n,s,a,o,l;t=t.channel,client.channels[t.chanid]={},n=client.channels[t.chanid],n.settings={},n.users={},n.chanid=t.chanid,n.channame=t.title,n.maxmsgid=0,n.minmsgid=null,n.settings.topic=t.topic,n.settings.private=t.private=="1"?!0:!1,n.settings.moderated=t.moderated=="1"?!0:!1,n.settings.autoclear=t.autoclear=="1"?!0:!1,s=null,a=null,o=null;for(l in t.users)s=t.users[l],o=s.id,n.users[o]={},a=n.users[o],a.userid=o,a.nick=s.nick,a.status=s.status;client.handle_messages(t.messages,t.chanid,!0,!1),Terminal.openChannelWin(t.title,t.chanid),Terminal.swapChannel(t.chanid,!1),Terminal.scrollToBottom()},hevt_leave:function(e,t){Terminal.swapChannel(getChanIDFromOffset(-1),!0),delete client.channels[t.chanid],Terminal.removeChannel(t.chanid),Terminal.removeChannelWin(t.chanid),Terminal.scrollToBottom()},hevt_retrieveold:function(e,t){t.messages.reverse(),client.handle_messages(t.messages,t.chanid,!0,!0)},hevt_whisper:function(e,t){e.arguments.timestamp=e.timestamp,Terminal.print_whisper(e.arguments,!1),Terminal.scrollToBottom()},hsrv_join:function(){var e,t,n;this.call_hook(client.hk_user_joined_pre,this.arguments),e=this.arguments.chanid,t=client.channels[e],t!==void 0&&(n=t.users[this.arguments.suserid]={},n.userid=this.arguments.suserid,n.nick=this.arguments.susernick,n.status=null,this.call_hook(client.hk_user_joined_post,this.arguments))},hsrv_leave:function(){var e,t;if(console.log(this.arguments),this.call_hook(client.hk_user_left_pre,this.arguments),e=this.arguments.chanid,t=client.channels[e],t!==void 0){if(this.arguments.duserid==client.usrid)return client.hevt_leave.apply(this,[this,this.arguments]),void 0;delete t.users[this.arguments.duserid],this.call_hook(client.hk_user_left_post,this.arguments)}},hsrv_modify_ops:function(){var e,t,n;this.arguments.duserid||(this.arguments.duserid=this.arguments.userid),this.call_hook(client.hk_user_changed_pre,this.arguments),e=this.arguments.chanid,t=client.channels[e],t!==void 0&&(n=t.users[this.arguments.duserid],n!==void 0&&(n.status=this.evtref._eventid==ESRV_SETOPS_CHANOPS_ON?"operator":this.evtref._eventid==ESRV_SETOPS_VOICE_ON?"voice":this.evtref._eventid==ESRV_JOINOPS_CHANOPS?"operator":this.evtref._eventid==ESRV_JOINOPS_VOICEOPS?"voice":"",this.arguments.status=n.status,this.call_hook(client.hk_user_changed_post,this.arguments)))},hsrv_modify_chan:function(){var e,t;this.call_hook(client.hk_channel_changed_pre,this.arguments),e=this.arguments.chanid,t=client.channels[e],t!==void 0&&(this.evtid==ESRV_MODIFY_TOPIC?t.settings.topic=this.arguments.topic:this.evtid==ESRV_MODIFY_MODERATED_ON?t.settings.moderated=!0:this.evtid==ESRV_MODIFY_MODERATED_OFF?t.settings.moderated=!1:this.evtid==ESRV_MODIFY_PRIVATE_ON?t.settings.private=!0:this.evtid==ESRV_MODIFY_PRIVATE_OFF?t.settings.private=!1:this.evtid==ESRV_MODIFY_AUTOCLEAR_ON?t.settings.autoclear=!0:this.evtid==ESRV_MODIFY_AUTOCLEAR_OFF&&(t.settings.autoclear=!1),this.call_hook(client.hk_channel_changed_post,this.arguments))},call_hook:function(e,t){typeof e=="function"&&e.call(this,t)},hk_initialize_pre:null,hk_initialize_post:null,hk_longpoll_pre:null,hk_longpoll_post:null,hk_longpoll_success:null,hk_longpoll_error:null,hk_messagesreceived_post:null,hk_user_left_pre:null,hk_user_left_post:null,hk_user_joined_pre:null,hk_user_joined_post:null,hk_user_changed_pre:null,hk_user_changed_post:null,hk_channel_changed_pre:null,hk_channel_changed_post:null,_tMessageCreated:null},Event=function(){return this.eventid=0,this.evtref=null,this.timestamp=Date.now(),this.client=client,this.fromObject=function(e){this.arguments={};for(var t in e)this[t]=e[t],this.arguments[t]=e[t];return e.eventid&&(this.evtref=Events.Event[e.eventid]),this},this.read=function(t,n){var s,a,o,l,r,h,c,u;try{this.arguments={};for(s in t)this.arguments[s]=t[s];if(t.type=="event")if(a=t.message.match(/^\S+/),a.length==1)if(a=a[0],this.evtref=Events.ServerEvent[a],this.evtref!=void 0){for(o=this.evtref.parseFormat,l="^\\S+",r=o.length,h=0;r>h;h++)l+="(?:\\s+("+(h+1==r?".+":"\\S+")+"))?";for(c=t.message.match(l),c.shift(),h=0;c.length>h;h++)this.arguments[this.evtref.parseFormat[h]]=c[h];u=this.arguments,this.arguments.message=this.evtref.message.replace(/(%\w+)/g,function(e){return e=e.slice(1),u[e]?u[e]:""}),n||this.call_hook(this.evtref.handler)}else hk_server_event_from_undefined_event();else hk_server_event_from_undefined_event()}catch(g){this.call_hook(hk_server_event_exception_thrown,g)}return this},this.parse=function(e){var t,n,s,a,o,l,r;if(t=e.match(/^\/(\S*)/),t&&t.length>=2){if(t=t[1],!(this.eventid=Events.getCommandID(t)))return this.call_hook(hk_event_unknown_command,e),!1;if(this.evtref=Events.Event[this.eventid],this.arguments={},n=this.evtref.parseFormat){for(s="^\\/\\S+",a=n.length,o=0;a>o;o++)n[o].value||(s+="(?:\\s+("+(o+1==a&&n[o].continuous?".+":"\\S+")+(n[o].optional?"))?":"))"));if(l=e.match(s),!l)return this.call_hook(hk_event_parsed_bad_format,{string:e,command:t,event:this.evtref}),!1;for(l.shift(),o=0;l.length>o;o++)l[o]!==void 0&&(this[n[o].name]=l[o],this.arguments[n[o].name]=l[o]);for(o=0;a>o;o++)n[o].value&&(this[n[o].name]=n[o].value,this.arguments[n[o].name]=n[o].value);if(this.evtref.flags&EFLG_APPENDCHANID&&(r=client.getActiveChanID(),this.chanid=r,this.arguments.chanid=r),this.call_hook(this.evtref.hooks.parsed)==0)return this.call_hook(hk_event_parsed_bad_format,{string:e,command:t,event:this.evtref}),!1;this.evtref.flags&EFLG_EXECUTE&&this.execute()}}else if(e.length>0)return this.parse("/message "+e);return this},this.execute=function(){return this.call_hook(this.evtref.hSuccess),this},this.request=function(e){return e&&(this.cb_success=e,this.cb_success_context=arguments.callee),this.client.request(this),this},this.hook_context=this,this.call_hook=function(e,t){return typeof e=="function"?e.call(this.hook_context,this,t):!0},this},Message=function(e,t,n,s,a,o){var l,r,h,c,u,g,d,m,p,_,f,v,k,y,E;return l=$("<span/>").addClass("chanitem").addClass("chanid-"+e),r=$("<span/>").addClass("msg-message").appendTo(l),h=Message.prototype.getClassesFromType(n),c=function(e){return e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;")},u=function(e,t){if(e&&t)for(var n=0;t.length>n;n++)e.addClass(t[n])},g=function(e){var t=settings.colourMap;return e=e.replace(/\^(1[0-5]|[0-9])/g,function(e){return"<a style='color: "+t[arguments[1]]+"'>"}),e+="</a>"},d=function(e){var t,n,s;t=settings.emoticonMap;for(n in t)s=RegExp(n,"gi"),e=e.replace(s,'<img class="emoticon" src="images/emoticons/'+t[n]+'" />');return e},m=function(e){return e=e.replace(/((https?:\/\/|(www\.))([\da-z\-\Q_.\E]+\.[a-z]+[a-z\d\-\Q_!.?=&%#*\/\E]*))/gi,"<a href='http://$3$4' target='_blank'>$1</a>")},u(l,h.container),u(r,h.message),a&&(p=$("<span/>").addClass("msg-user").prependTo(l),n.match(/action/)?p.text("*"+a+" "):n.match(/whisper/)?p.text("-"+a+"-"):n.match(/event/)?p.text(""):p.text(a+" says: "),u(p,h.user)),s&&(k=new Date(s.replace(/-/g,"/")),y=isNaN(k.getSeconds())?new Date(s):k,_=y.getSeconds(),(""+_).length==1&&(_="0"+_),f=y.getMinutes(),(""+f).length==1&&(f="0"+f),v=y.getHours(),v>12&&(v-=12),s=""+v+":"+f+":"+_+"  ",E=$("<span/>").addClass("msg-time").text(s).prependTo(l),u(E,h.time)),!o&&t&&(t=m(d(g(c(t))))),r.html(t),l},Terminal=function(){var e={print:null,print_0:null,print_all:null,print_preset:null,print_message:null,print_whisper:null,scrollToBottom:null,swapChannel:null,removeChannel:null,removeChannels:null,resizePage:null,openChannel:null,hk_swapChannel_pre:null,hk_swapChannel_post:null,loadOlder:null,hideBody:null,showBody:null};return function(){e.print=function(e,t,n,s,i,a,o){var l=new Message(e,t,n,s,i,o);a?l.prependTo("#console"):l.appendTo("#console")},e.print_all=function(t,n,s,a,o,l){for(var r in client.channels)e.print(client.channels[r].chanid,t,n,s,a,o,l)},e.print_0=function(t,n,s,i,a,o){e.print(0,t,n,s,i,a,o)},e.print_preset=function(t){var n,s,i=settings.messages[t];if(!i)throw Error("Could not find settings.message["+t+"]");for(s=i.messages.length,n=0;s>n;n++)i.chanid==0?e.print(0,i.messages[n],i.type):e.print(client.activeChanRef.chanid,i.messages[n],i.type)},e.print_message=function(t,n,s,a){var o,l;if(t!=null)n.userid==client.usrid&&(n.type="self-"+n.type),n.old==1&&(n.type="old-"+n.type),l=new Message(t,n.message,n.type,n.timestamp,n.nick,a),s?l.prependTo("#console"):l.appendTo("#console");else for(o in client.channels)e.print_message(client.channels[o].chanid,n,s,a)},e.print_whisper=function(e,t){var n,s,a,o;n=new Date(e.timestamp),s="whisper";for(a in client.channels)o=new Message(a,e.message,s,n+"",e.nick),o.appendTo("#console")},e.swapChannel=function(t,n){var s,i;typeof e.hk_swapChannel_pre=="function"&&e.hk_swapChannel_pre.apply(this,[t,n]),client.activeChanRef=client.channels[t];try{s=document.getElementById("styleChanDisplay"),s.innerHTML=".chanitem { display:block; } #console .chanitem:not(.chanid-"+t+") { display:none !important; } ",document.getElementsByTagName("head").item(0).removeChild(s),document.getElementsByTagName("head").item(0).appendChild(s)}catch(a){$("#console").css({display:"none"}),$(".chanitem:not(.chanid-"+t+")").css({display:"none !important"}),$(".chanid-"+t).css({display:"block !important"}),$("#console").css({display:"block"})}try{i=document.getElementById("chan-title"),i.textContent=client.activeChanRef.channame}catch(a){}setTimeout(function(){e.resizePage(),e.scrollToBottom(!0)},200),typeof e.hk_swapChannel_post=="function"&&e.hk_swapChannel_post.apply(this,[t,n])},e.removeChannel=function(e){$(".chanid-"+e).remove()},e.removeChannels=function(){$(".chanitem:not(.chanid-0)").remove()},e.openChannelWin=function(){},e.closeChannelWin=function(){},e.scrollToBottom=function(){},e.resizePage=function(){},function(){var t="wrapper-console",n=document.body,s=250,i=function(){return(_foundEl=document.getElementById(t))?(n=_foundEl,void 0):(setTimeout(i,s),void 0)};e.hideBody=function(){n.style.display="none"},e.showBody=function(){n.style.display=""},i()}(),e.loadOlder=function(e){var t={load:null},n=e;return t.load=function(e){n.activeChanRef.chanid!=0&&(new Event).fromObject({eventid:"ECMD_RETRIEVEOLD",maxmsgid:n.activeChanRef.minmsgid,chanid:n.activeChanRef.chanid}).request(e)},t}(client)}(),e}()