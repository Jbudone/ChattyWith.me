var settings,client,Event,Message,Terminal;settings=function(){var e={message_maxlen:512,pingEnabled:!0,useLongpollPing:!0,pingTimer:750,pingTimeout:3e3,longpollRetry:750,longpollTimeout:4e4,minPingTimeoutsToDisconnect:10,maxTimeSinceLastPingToDisconnect:125e3,hideBodyOnMessage:!1,checkIfActiveTimer:100,colourMap:["white","","navy","green","red","maroon","purple","olive","orange","lime","teal","aqua","royalBlue","fuchsia","grey","silver"],emoticonMap:{"\\:DD":"grin.gif","\\(H\\)":"cool.gif","\\:S":"confused2.gif","\\:D":"open-smile.gif","\\:P":"tongue.gif","\\(Y\\)":"thumbs-up.gif","\\(N\\)":"thumbs-down.gif","\\(BD\\)":"nerd.gif","\\(\\=\\\\\\)":"mouth-at-side.gif","\\(\\=\\/\\)":"mouth-at-side.gif","\\:X":"lips-are-sealed.gif","\\:\\$":"embarrassed.gif","\\(\\:\\(":"sad.gif","\\:\\(\\(":"depressed.gif","\\:\\(":"frown.gif","\\:\\'\\(":"crying.gif","0\\:\\)":"angelic.gif","\\:\\)":"happy.gif","\\^o\\)":"not-sure.gif","\\+o\\(":"being-sick.gif","\\(8\\)":"music.png","\\(Y\\)":"sleepy.gif",'\\:\\"\\(':"crying2.gif","\\(BD2\\)":"dork.gif","\\+oP":"ill.gif","\\:R":"tongue2.gif","\\(hubba\\)":"hubba_hubba.gif","\\(laugh\\)":"laugh.gif","\\(\\:\\(":"sad.gif","\\(BH\\)":"cool2.gif",'\\:\\"D':"crying_with_laughter.gif","\\(0o\\)":"black_eye.gif","\\;\\)":"wink.gif","\\;S":"confused.gif","\\:\\@":"angry.gif","\\:Z":"zip.gif","\\:O":"surprised.gif","\\(L\\)":"heart.png","\\(der\\)":"caveman.gif"},messages:{loaded:{chanid:0,type:"startup",messages:["Welcome to ^8ChattyWith.me ^14!!!,","^14  An AJAX approach to IRC"," "]},loaded_mobile:{chanid:0,type:"startup",messages:["Welcome to ^8ChattyWith.me ^14!!!,","^14  An AJAX approach to IRC","^15  The ^0mobile^15 edition"," "]},loaded_loggedout:{chanid:0,type:"startup",messages:["Now that ^8ChattyWith^15.^8me ^1has loaded","	you may pick a nickname to start chatting by. Type ^0/nick ^15[^9username^15] ^1to choose your username.","	example, ^0/nick ^9superman","	or perhaps ^0/nick ^9leeroyjenkins"]},loaded_loggedout_mobile:{chanid:0,type:"startup",messages:["Now that ^8ChattyWith^15.^8me ^11has loaded","Pick a nickname to start chatting, like this: ^0/nick ^15[^9username^15] ^1to choose your username.","  example, ^0/nick ^9superman","  or perhaps ^0/nick ^9leeroyjenkins"]},logon:{chanid:0,type:"startup",messages:["Now that you have logged in it is time to start chatting","Type the following to join the room called 'lolfun': ^0/join ^9#lolfun","Or otherwise, click the list icon on the right to display a list of all public chatrooms","Have fun, stay a while and make some friends."," "," ","	Author: ^0JB Braendel","   You can find me on,","   ^15Portal^1: http://jbud.me","   ^15Twitter^1: https://twitter.com/#!/thatsjb","   ^15Facebook^1: http://www.facebook.com/jb.braendel","   ^15Github^1: https://github.com/Jbudone/ChattyWith.me"," ","Thanks go out to: ^0jQuery^1, ^0LESS","Beautiful Background from: http://fullhdwallpapers.info/abstract/colorful-abstract-wallpaper-2/"]},logon_mobile:{chanid:0,type:"startup",messages:[" ","Now that you have logged in it is time to start chatting","Type the following to join the room called 'lolfun': ^0/join ^9#lolfun","Have fun, stay a while and make some friends."," "," ","	Author: JB Braendel"," ","Thanks go out to: ^0jQuery^1, ^0jQuery-Mobile"," ","Supported Devices: ^0iOS3","Untested Devices: ^0iOS4+^1, ^0Android^1, ^0Blackberry^1, ^0Windows Phone^1, ^0Symbian"," "]}}};return e}(),client={lConsole:null,usrIdentification:null,usrNick:null,usrid:null,channels:{0:{channame:"server",chanid:0}},ignoreChannels:[],activeChanRef:null,_prevChanid:null,initialReconnect:!1,initialize:function(){this.call_hook(this.hk_initialize_pre),this.activeChanRef=this.channels[0],this._prevChanid=this.channels[0].chanid,lEvents=$("#_events");var e=document.createElement("script");e.defer=!0,e.innerHTML=lEvents.html().slice(2,-2),e.innerHTML+=" client.initialize_finalize();",document.getElementsByTagName("head").item(0).appendChild(e),lEvents.remove()},initialize_finalize:function(){Events.Event[ECMD_JOIN].hooks.parsed=client.hevt_join_parse,Events.Event[ECMD_LEAVE].hooks.reqPre=client.hevt_leave_parse,Events.Event[ECMD_CHANOP].hooks.parsed=client.hevt_chanop_parse,Events.Event[ECMD_MESSAGE].hooks.parsed=client.hevt_message_parse,Events.Event[ECMD_ACTION].hooks.parsed=client.hevt_message_parse,Events.Event[ECMD_PINGCHAN].hooks.reqSuccess=function(){},Events.Event[ECMD_PINGCHAN].hooks.reqSuccessError=function(){},this.auto_ping(),this.call_hook(this.hk_initialize_post)},getActiveChanID:function(){return this.activeChanRef==null?0:this.activeChanRef.chanid},getChanNameFromID:function(e){return this.channels[e]?this.channels[e].channame:""},longpoll:function(){this.call_hook(this.hk_longpoll_pre);var e,n=this.channels,t={};for(e in n)t[e]={chanid:e,maxmsgid:n[e].maxmsgid};getChanCount()>=2||this.initialReconnect&&!(this.initialReconnect=!this.initialReconnect)?($.ajax({async:"true",cache:"false",dataType:"json",type:"GET",url:"system/longpolling.php",data:{channels:t,ignore:this.ignoreChannels,identification:this.usrIdentification},context:this,success:this._cblongpoll,error:this._errlongpoll,timeout:settings.longpollTimeout}),this.call_hook(this.hk_longpoll_post)):setTimeout(function(){client.longpoll.apply(client)},settings.longpollRetry)},_errlongpoll:function(e,n,t){console.log("longpoll error.."),console.log(n),setTimeout(function(){client.longpoll.apply(client)},settings.longpollRetry),this.call_hook(this.hk_longpoll_error,this.arguments)},_cblongpoll:function(e){var n,t;if(this.call_hook(this.hk_longpoll_success,e),window.Terminal.hideBody(),n=!1,e.channels){n=!0;for(t in e.channels)this.handle_messages(e.channels[t],t,!1,!1)}else e.whispers&&(n=!0,this.handle_whispers(e.whispers));if(e.newchannels)for(t in e.newchannels)this.channels[t]!==void 0?(n=!0,this.handle_messages(e.newchannels[t],t,!1,!1)):this.hevt_join(null,e.newchannels[t]);n&&this.call_hook(this.hk_messagesreceived_post),this.usrIdentification&&this.longpoll(),window.Terminal.showBody()},request:function(n){if(n.evtref==null)return n.call_hook(hk_event_request_from_undefined_event),!1;try{n.evtref.hooks&&n.call_hook(n.evtref.hooks.reqPre);var t={request:n.evtref.request,identification:this.usrIdentification};n.arguments&&(t.args=n.arguments),$.ajax({async:"true",cache:"false",dataType:"json",type:"GET",url:"system/requests.json.php",data:t,context:n,success:this.evt_handle_success,error:this.evt_handle_error}),n.evtref.hooks&&n.call_hook(n.evtref.hooks.reqPost)}catch(s){return n.call_hook(hk_event_request_exception_thrown,s),!1}return!0},auto_ping:function(){var n,t,s,i;if(settings.pingEnabled&&!settings.useLongpollPing){n=[],t=0,s=null;for(t in client.channels)t!=0&&n.push(t);if(n.length==0)return window.console.log("auto_ping:: _channels.length==0"),setTimeout(client.auto_ping,settings.pingTimer),void 0;s=(new Event).fromObject({eventid:"ECMD_PINGCHAN"});try{s.evtref.hooks&&s.call_hook(s.evtref.hooks.reqPre),i={request:"pingchan",identification:client.usrIdentification,args:{channels:n}},$.ajax({async:"true",cache:"false",dataType:"json",type:"GET",url:"system/requests.json.php",data:i,context:s,success:client.auto_ping_cb,error:client.auto_ping_err,timeout:settings.pingTimeout}),s.evtref.hooks&&s.call_hook(s.evtref.hooks.reqPost),s.args=i,s.args.sent=(new Date).getTime()}catch(a){return s.call_hook(hk_event_request_exception_thrown,a),!1}}},auto_ping_cb:function(e){var n,t,s;if(e.response!=2||e.pinged=="0"&&0<this.args.args.channels.length)if(t=function(){for(var e in client.channels)e!=0&&((new Event).fromObject({eventid:"ECMD_JOIN",channelname:client.channels[e].channame}).request(),delete client.channels[e],Terminal.removeChannel(e),Terminal.removeChannelWin(e));Terminal.swapChannel(0,!0),Terminal.scrollToBottom()},e.error){if(window.console.log("auto_ping_cb:: data error,"),window.console.log(e.error),e.error==10);else if(client.usrIdentification)return s=function(){$.ajax({async:"true",cache:"false",dataType:"json",type:"GET",url:"system/requests.json.php",data:{request:"identify",args:{id:client.usrIdentification}},context:this,success:function(e){console.log("Successful Response on Re-login request.."),e.response==2?(console.log("Silently Re-logged in"),console.log("Attempting to rejoin channels after disconnect"),t()):s()},error:function(e){console.log("ERROR re-attemping login..trying again"),s()},timeout:settings.pingTimeout}),this.call_hook(this.evtref.hooks.reqSuccessError,n)},s(),void 0}else window.console.log("auto_ping_cb:: error without data.error"),e.pinged=="0"&&this.args.args.channels.length>0&&(console.log("Attempting to rejoin channels after disconnect"),t());else n=(new Date).getTime()-this.args.sent,this.call_hook(this.evtref.hooks.reqSuccess,n);setTimeout(client.auto_ping,settings.pingTimer)},auto_ping_err:function(e){window.console.log("auto_ping_err:: data error,"),window.console.log(e.error),this.call_hook(this.evtref.hooks.reqSuccessError,e),setTimeout(client.auto_ping,settings.pingTimer)},handle_whispers:function(e){var n,t,s,a;for(n=null,t=null,s=null,a=0,n=e.length;n>a;a++)t=e[a],t.type="whisper",s=new Event,s.read(t,!1),s.call_hook(hk_server_event_append_whisper),delete s},handle_messages:function(e,n,t,s){this.call_hook(hk_server_event_add_messages_started);var a=null,o=null,l=null,r=null,h=null;if(a=this.channels[n],a!==void 0)for(r=this.getChanNameFromID(n),h=0,msgLength=e.length;msgLength>h;h++){if(o=e[h],o.id>a.maxmsgid)a.maxmsgid=parseInt(o.id),a.minmsgid==null&&(a.minmsgid=parseInt(o.id));else{if(t!=1||o.id>=a.minmsgid)continue;a.minmsgid=parseInt(o.id)}o.chanid=n,o.channame=r,o.old=t,l=new Event,l.read(o,t),s?l.call_hook(hk_server_event_prepend_message):l.call_hook(hk_server_event_append_message),delete l}this.call_hook(hk_server_event_add_messages_completed)},handle_evtMessage:function(e){var n,t,s,a,o,l,r;for(n=e.message,t=e.type,s=e.data,a=n.split("\\n"),o=function(e){return e=e.slice(1),s[e]?s[e]:""},l=0;a.length>l;l++)a[l]=a[l].replace(/(%\w+)/g,o);if(s.error)try{for(r="",r=errCodes[s.error].message.replace(/(%\w+)/g,o),s.errMsg=r,l=0;a.length>l;l++)a[l]=a[l].replace(/\$ERRMSG/gi,r),a[l]=a[l].replace(/\$ERRID/gi,s.error)}catch(h){s.errMsg=""}for(l=0;a.length>l;l++)this.call_hook(hk_server_event_append_log,{message:a[l],type:t})},evt_handle_success:function(e){e&&e.response==2?(this.evtref.hSuccess&&this.call_hook(this.evtref.hSuccess,e),this.evtref.hooks&&this.call_hook(this.evtref.hooks.reqSuccess,e),_callSuccessMessage=!0,this.cb_success&&(_callSuccessMessage=this.cb_success.call(this.cb_success_context,e)),_callSuccessMessage&&this.evtref.mSuccess&&client.handle_evtMessage.call(this,{data:e,message:this.evtref.mSuccess,type:"success"})):(e.error!==void 0&&this.call_hook(hk_server_response_error,errCodes[e.error]),this.evtref.hooks&&this.call_hook(this.evtref.hooks.reqSuccessError,e),this.evtref.mError&&client.handle_evtMessage.call(this,{data:e,message:this.evtref.mError,type:"error"}))},evt_handle_error:function(e,n,t){this.request()},hevt_chanop_parse:function(){var e=this.arguments.optype;e=e.match(/^(\+o|chanop|ops|op|operator|\+op|chanops|owner|chanowner|\+owner|\+chanowner|o|\+ops)$/i)?"0":e.match(/^(\+v|voice|chanvoice|v|\+voice)$/i)?"1":"2",this.arguments.optype=e},hevt_message_parse:function(){this.arguments.message=encodeURIComponent(this.arguments.message)},hevt_join_parse:function(){return this.arguments.channelname[0]=="#"?(this.arguments.channelname=this.arguments.channelname.slice(1),this.arguments.channelname!==""):void 0},hevt_leave_parse:function(){this.arguments.chanid=client.activeChanRef.chanid},hevt_login:function(e,n){client.usrNick=n.nick,client.usrIdentification=n.identification,client.usrid=n.userid,client.initialReconnect=!0,client.longpoll(),localStorage.setItem("identification",n.identification)},hevt_logout:function(e,n){client.usrIdentification=null,client.usrid=null,Terminal.swapChannel(0,!0),Terminal.removeChannels(),Terminal.removeChannelWins(),Terminal.scrollToBottom(),client.channels={0:client.channels[0]},localStorage.removeItem("identification")},hevt_join:function(e,n){var t,s,a,o,l;n=n.channel,client.channels[n.chanid]={},t=client.channels[n.chanid],t.settings={},t.users={},t.chanid=n.chanid,t.channame=n.title,t.maxmsgid=0,t.minmsgid=null,t.settings.topic=n.topic,t.settings.private=n.private=="1"?!0:!1,t.settings.moderated=n.moderated=="1"?!0:!1,t.settings.autoclear=n.autoclear=="1"?!0:!1,s=null,a=null,o=null;for(l in n.users)s=n.users[l],o=s.id,t.users[o]={},a=t.users[o],a.userid=o,a.nick=s.nick,a.status=s.status;client.handle_messages(n.messages,n.chanid,!0,!1),Terminal.openChannelWin(n.title,n.chanid),Terminal.swapChannel(n.chanid,!1),Terminal.scrollToBottom()},hevt_leave:function(e,n){Terminal.swapChannel(getChanIDFromOffset(-1),!0),delete client.channels[n.chanid],Terminal.removeChannel(n.chanid),Terminal.removeChannelWin(n.chanid),Terminal.scrollToBottom()},hevt_retrieveold:function(e,n){n.messages.reverse(),client.handle_messages(n.messages,n.chanid,!0,!0)},hevt_whisper:function(e,n){e.arguments.timestamp=e.timestamp,Terminal.print_whisper(e.arguments,!1),Terminal.scrollToBottom()},hsrv_join:function(){var e,n,t;this.call_hook(client.hk_user_joined_pre,this.arguments),e=this.arguments.chanid,n=client.channels[e],n!==void 0&&(t=n.users[this.arguments.suserid]={},t.userid=this.arguments.suserid,t.nick=this.arguments.susernick,t.status=null,this.call_hook(client.hk_user_joined_post,this.arguments))},hsrv_leave:function(){var e,n;if(console.log(this.arguments),this.call_hook(client.hk_user_left_pre,this.arguments),e=this.arguments.chanid,n=client.channels[e],n!==void 0){if(this.arguments.duserid==client.usrid)return client.hevt_leave.apply(this,[this,this.arguments]),void 0;delete n.users[this.arguments.duserid],this.call_hook(client.hk_user_left_post,this.arguments)}},hsrv_modify_ops:function(){var e,n,t;this.arguments.duserid||(this.arguments.duserid=this.arguments.userid),this.call_hook(client.hk_user_changed_pre,this.arguments),e=this.arguments.chanid,n=client.channels[e],n!==void 0&&(t=n.users[this.arguments.duserid],t!==void 0&&(t.status=this.evtref._eventid==ESRV_SETOPS_CHANOPS_ON?"operator":this.evtref._eventid==ESRV_SETOPS_VOICE_ON?"voice":this.evtref._eventid==ESRV_JOINOPS_CHANOPS?"operator":this.evtref._eventid==ESRV_JOINOPS_VOICEOPS?"voice":"",this.arguments.status=t.status,this.call_hook(client.hk_user_changed_post,this.arguments)))},hsrv_modify_chan:function(){var e,n;this.call_hook(client.hk_channel_changed_pre,this.arguments),e=this.arguments.chanid,n=client.channels[e],n!==void 0&&(this.evtid==ESRV_MODIFY_TOPIC?n.settings.topic=this.arguments.topic:this.evtid==ESRV_MODIFY_MODERATED_ON?n.settings.moderated=!0:this.evtid==ESRV_MODIFY_MODERATED_OFF?n.settings.moderated=!1:this.evtid==ESRV_MODIFY_PRIVATE_ON?n.settings.private=!0:this.evtid==ESRV_MODIFY_PRIVATE_OFF?n.settings.private=!1:this.evtid==ESRV_MODIFY_AUTOCLEAR_ON?n.settings.autoclear=!0:this.evtid==ESRV_MODIFY_AUTOCLEAR_OFF&&(n.settings.autoclear=!1),this.call_hook(client.hk_channel_changed_post,this.arguments))},call_hook:function(e,n){typeof e=="function"&&e.call(this,n)},hk_initialize_pre:null,hk_initialize_post:null,hk_longpoll_pre:null,hk_longpoll_post:null,hk_longpoll_success:null,hk_longpoll_error:null,hk_messagesreceived_post:null,hk_user_left_pre:null,hk_user_left_post:null,hk_user_joined_pre:null,hk_user_joined_post:null,hk_user_changed_pre:null,hk_user_changed_post:null,hk_channel_changed_pre:null,hk_channel_changed_post:null,_tMessageCreated:null},Event=function(){return this.eventid=0,this.evtref=null,this.timestamp=Date.now(),this.client=client,this.fromObject=function(e){this.arguments={};for(var n in e)this[n]=e[n],this.arguments[n]=e[n];return e.eventid&&(this.evtref=Events.Event[e.eventid]),this},this.read=function(n,t){var s,a,o,l,r,h,c,u;try{this.arguments={};for(s in n)this.arguments[s]=n[s];if(n.type=="event")if(a=n.message.match(/^\S+/),a.length==1)if(a=a[0],this.evtref=Events.ServerEvent[a],this.evtref!=void 0){for(o=this.evtref.parseFormat,l="^\\S+",r=o.length,h=0;r>h;h++)l+="(?:\\s+("+(h+1==r?".+":"\\S+")+"))?";for(c=n.message.match(l),c.shift(),h=0;c.length>h;h++)this.arguments[this.evtref.parseFormat[h]]=c[h];u=this.arguments,this.arguments.message=this.evtref.message.replace(/(%\w+)/g,function(e){return e=e.slice(1),u[e]?u[e]:""}),t||this.call_hook(this.evtref.handler)}else hk_server_event_from_undefined_event();else hk_server_event_from_undefined_event()}catch(g){this.call_hook(hk_server_event_exception_thrown,g)}return this},this.parse=function(e){var n,t,s,a,o,l,r;if(n=e.match(/^\/(\S*)/),n&&n.length>=2){if(n=n[1],!(this.eventid=Events.getCommandID(n)))return this.call_hook(hk_event_unknown_command,e),!1;if(this.evtref=Events.Event[this.eventid],this.arguments={},t=this.evtref.parseFormat){for(s="^\\/\\S+",a=t.length,o=0;a>o;o++)t[o].value||(s+="(?:\\s+("+(o+1==a&&t[o].continuous?".+":"\\S+")+(t[o].optional?"))?":"))"));if(l=e.match(s),!l)return this.call_hook(hk_event_parsed_bad_format,{string:e,command:n,event:this.evtref}),!1;for(l.shift(),o=0;l.length>o;o++)l[o]!==void 0&&(this[t[o].name]=l[o],this.arguments[t[o].name]=l[o]);for(o=0;a>o;o++)t[o].value&&(this[t[o].name]=t[o].value,this.arguments[t[o].name]=t[o].value);if(this.evtref.flags&EFLG_APPENDCHANID&&(r=client.getActiveChanID(),this.chanid=r,this.arguments.chanid=r),this.call_hook(this.evtref.hooks.parsed)==0)return this.call_hook(hk_event_parsed_bad_format,{string:e,command:n,event:this.evtref}),!1;this.evtref.flags&EFLG_EXECUTE&&this.execute()}}else if(e.length>0)return this.parse("/message "+e);return this},this.execute=function(){return this.call_hook(this.evtref.hSuccess),this},this.request=function(e){return e&&(this.cb_success=e,this.cb_success_context=arguments.callee),this.client.request(this),this},this.hook_context=this,this.call_hook=function(e,n){return typeof e=="function"?e.call(this.hook_context,this,n):!0},this},Message=function(e,n,t,s,a,o){var l,r,h,c,u,g,d,m,p,_,f,v,k,y,E;return l=$("<span/>").addClass("chanitem").addClass("chanid-"+e),r=$("<span/>").addClass("msg-message").appendTo(l),h=Message.prototype.getClassesFromType(t),c=function(e){return e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;")},u=function(e,n){if(e&&n)for(var t=0;n.length>t;t++)e.addClass(n[t])},g=function(e){var n=settings.colourMap;return e=e.replace(/\^(1[0-5]|[0-9])/g,function(e){return"<a style='color: "+n[arguments[1]]+"'>"}),e+="</a>"},d=function(e){var n,t,s;n=settings.emoticonMap;for(t in n)s=RegExp(t,"gi"),e=e.replace(s,'<img class="emoticon" src="images/emoticons/'+n[t]+'" />');return e},m=function(e){return e=e.replace(/((https?:\/\/|(www\.))([\da-z\-\Q_.\E]+\.[a-z]+[a-z\d\-\Q_!.?=&%#*\/\E]*))/gi,"<a href='http://$3$4' target='_blank'>$1</a>")},u(l,h.container),u(r,h.message),a&&(p=$("<span/>").addClass("msg-user").prependTo(l),t.match(/action/)?p.text("*"+a+" "):t.match(/whisper/)?p.text("-"+a+"-"):t.match(/event/)?p.text(""):p.text(a+" says: "),u(p,h.user)),s&&(k=new Date(s.replace(/-/g,"/")),y=isNaN(k.getSeconds())?new Date(s):k,_=y.getSeconds(),(""+_).length==1&&(_="0"+_),f=y.getMinutes(),(""+f).length==1&&(f="0"+f),v=y.getHours(),v>12&&(v-=12),s=""+v+":"+f+":"+_+"  ",E=$("<span/>").addClass("msg-time").text(s).prependTo(l),u(E,h.time)),!o&&n&&(n=m(d(g(c(n))))),r.html(n),l},Terminal=function(){var e={print:null,print_0:null,print_all:null,print_preset:null,print_message:null,print_whisper:null,scrollToBottom:null,swapChannel:null,removeChannel:null,removeChannels:null,resizePage:null,openChannel:null,hk_swapChannel_pre:null,hk_swapChannel_post:null,loadOlder:null,hideBody:null,showBody:null};return function(){e.print=function(e,n,t,s,i,a,o){var l=new Message(e,n,t,s,i,o);a?l.prependTo("#console"):l.appendTo("#console")},e.print_all=function(n,t,s,a,o,l){for(var r in client.channels)e.print(client.channels[r].chanid,n,t,s,a,o,l)},e.print_0=function(n,t,s,i,a,o){e.print(0,n,t,s,i,a,o)},e.print_preset=function(n){var t,s,i=settings.messages[n];if(!i)throw Error("Could not find settings.message["+n+"]");for(s=i.messages.length,t=0;s>t;t++)i.chanid==0?e.print(0,i.messages[t],i.type):e.print(client.activeChanRef.chanid,i.messages[t],i.type)},e.print_message=function(n,t,s,a){var o,l;if(n!=null)t.userid==client.usrid&&(t.type="self-"+t.type),t.old==1&&(t.type="old-"+t.type),l=new Message(n,t.message,t.type,t.timestamp,t.nick,a),s?l.prependTo("#console"):l.appendTo("#console");else for(o in client.channels)e.print_message(client.channels[o].chanid,t,s,a)},e.print_whisper=function(e,n){var t,s,a,o;t=new Date(e.timestamp),s="whisper";for(a in client.channels)o=new Message(a,e.message,s,t+"",e.nick),o.appendTo("#console")},e.swapChannel=function(n,t){var s,i;client._prevChanid=client.activeChanRef.chanid,typeof e.hk_swapChannel_pre=="function"&&e.hk_swapChannel_pre.apply(this,[n,t]),client.activeChanRef=client.channels[n];try{s=document.getElementById("styleChanDisplay"),s.innerHTML=".chanitem { display:block; } #console .chanitem:not(.chanid-"+n+") { display:none !important; } ",document.getElementsByTagName("head").item(0).removeChild(s),document.getElementsByTagName("head").item(0).appendChild(s)}catch(a){$("#console").css({display:"none"}),$(".chanitem:not(.chanid-"+n+")").css({display:"none !important"}),$(".chanid-"+n).css({display:"block !important"}),$("#console").css({display:"block"})}try{i=document.getElementById("chan-title"),i.textContent=client.activeChanRef.channame}catch(a){}setTimeout(function(){e.resizePage(),e.scrollToBottom(!0)},200),typeof e.hk_swapChannel_post=="function"&&e.hk_swapChannel_post.apply(this,[n,t])},e.removeChannel=function(e){$(".chanid-"+e).remove()},e.removeChannels=function(){$(".chanitem:not(.chanid-0)").remove()},e.openChannelWin=function(){},e.closeChannelWin=function(){},e.scrollToBottom=function(){},e.resizePage=function(){},function(){var n="wrapper-console",t=document.body,s=250,i=function(){return(_foundEl=document.getElementById(n))?(t=_foundEl,void 0):(setTimeout(i,s),void 0)};settings.hideBodyOnMessage?(e.hideBody=function(){t.style.display="none"},e.showBody=function(){t.style.display=""}):(e.hideBody=function(){},e.showBody=function(){}),i()}(),e.loadOlder=function(e){var n={load:null},t=e;return n.load=function(e){t.activeChanRef.chanid!=0&&(new Event).fromObject({eventid:"ECMD_RETRIEVEOLD",maxmsgid:t.activeChanRef.minmsgid,chanid:t.activeChanRef.chanid}).request(e)},n}(client)}(),e}()