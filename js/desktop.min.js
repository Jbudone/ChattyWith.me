var pre_setup,setupPage;(function(e){e.reflowTime=100,e.safeReflowTime=500,e.cubeSettings={transitionTime:400},e.userOptionsSettings={waitModeTimer:700,offsetTop:225,offsetLeft:330,minTop:0,animationTime:120},e.windowResizeSettings={interval:350,enabled:!1},e._promptPlaceholder="Type Inside of Me!"})(settings),pre_setup=function(){},Message.prototype.getClassesFromType=function(e){var t={user:[],time:[],message:[],container:[]};return e.match(/error/)?t.message=["message-error"]:e.match(/success/)?t.container=t.message=["message-success","ui-link"]:e.match(/action/)?t.container=t.message=t.user=["message-action"]:e.match(/message/)||e.match(/whisper/)||(e.match(/event/)?(t.container=["ui-link"],t.time=["hidden"]):t.container=e.match(/startup/)?["message-startup"]:["ui-link"]),e.match(/self/)&&(t.container=t.user=["message-self"]),e.match(/old/)&&(t.container=["message-old"]),t},Terminal.scrollToBottom=function(e){var t=250,n=150;(e||document.getElementById("console-cube-front").scrollTop+t>=document.getElementById("console-cube-front").scrollHeight-document.getElementById("console-cube-front").offsetHeight)&&setTimeout(function(){document.getElementById("console").scrollIntoView(!1)},n)},Terminal.hk_swapChannel_pre=function(t,n){settings.cubeSettings.transitionTime;try{document.getElementById("channels-selected").setAttribute("id",""),this._prevChanid=client.activeChanRef.chanid}catch(i){window.console.log(i)}finally{setTimeout(function(){leftPos=$('.channels-chanitem[chanid="'+t+'"]').attr({id:"channels-selected"}).position().left,document.getElementById("channels-selector").style.left=leftPos+"px"},settings.reflowTime)}},Terminal.hk_swapChannel_post=function(e,t){var n,i,o,c,s,r,a;n=document.getElementById("styleChanDisplay"),n.innerHTML+="#_console .chanitem:not(.chanid-"+this._prevChanid+") { display:none !important; } ",document.getElementsByTagName("head").item(0).removeChild(n),document.getElementsByTagName("head").item(0).appendChild(n),c=document.getElementById("rc-userlist"),s=client.activeChanRef.users,r=document.getElementById("rc-details-channame"),client.activeChanRef.users,r.innerHTML=client.channels[e].channame;while(c.children.length>0)c.removeChild(document.getElementById("rc-userlist").children[0]);if(s){o=document.createDocumentFragment();for(i in s)a=this._addUser(e,i,s[i].status,s[i].nick,!0),o.appendChild(a);c.appendChild(o)}setTimeout(function(){Terminal.scrollToBottom(!0)},settings.safeReflowTime),Terminal.messageNotification.openChan(e)},Terminal._addUser=function(e,t,n,i,o){if(client.activeChanRef.chanid==e){var c=document.createElement("a"),s=client.channels[e].users;return c.setAttribute("href","#"),c.setAttribute("status",n),c.userdetails={userid:t,status:n,nick:i,element:c},c.appendChild(document.createTextNode(i)),c.className="channel-user",c.onclick=c.oncontextmenu=function(){return Terminal._isUserBoxShowing?Terminal._switchUserBox(this.userdetails):Terminal._showUserBox(this.userdetails),!1},s[t]._element=c,o?c:(document.getElementById("rc-userlist").appendChild(c),void 0)}},Terminal._remUser=function(e,t){if(client.activeChanRef.chanid==e){var n=client.channels[e];$(n.users[t]._element).remove()}},Terminal._changeUser=function(e,t,n){if(client.activeChanRef.chanid==e){var i=client.channels[e].users;i[t].status=n,i[t]._element.setAttribute("status",n)}},Terminal.openChannelWin=function(e,t){var n=document.createElement("div"),i=document.createElement("a");n.className="channels-chanitem",n.setAttribute("chanid",""+t),i.className="channels-chanitem-link",i.setAttribute("chanid",""+t),i.setAttribute("href","#"),n.appendChild(i),document.getElementById("channels").appendChild(n),i.onclick=function(){var e=function(){var e,n=client,i=client.activeChanRef.chanid;for(e in n.channels){if(e==t)return!0;if(e==i)return!1}}();return Terminal.swapChannel(t,e),!1}},Terminal.removeChannelWin=function(e){$('.channels-chanitem[chanid="'+e+'"]').remove()},Terminal.removeChannelWins=function(){for(var e in client.channels)e!=0&&Terminal.removeChannelWin(e)},Terminal._isUserBoxShowing=!1,Terminal._showUserBox=function(e){this._isUserBoxShowing=!0,this._userBoxOnWaitMode=!0,setTimeout(function(){Terminal._userBoxOnWaitMode=!1},settings.userOptionsSettings.waitModeTimer),Terminal._userSelected=e,document.getElementById("user-optionscontainer").setAttribute("powermode",client.activeChanRef.users[client.usrid].status);var t=Math.max(settings.userOptionsSettings.minTop,$(e.element).offset().top-settings.userOptionsSettings.offsetTop),n=$(e.element).offset().left-settings.userOptionsSettings.offsetLeft,i=Math.min(0,$(e.element).offset().top-settings.userOptionsSettings.offsetTop-settings.userOptionsSettings.minTop);document.getElementById("user-optionscontainer").style.top=t+"px",document.getElementById("user-optionscontainer").style.left=n+"px",document.getElementById("user-optionscontainer").className="",document.getElementById("ob-container-string1").style.marginTop=i+"px",document.getElementById("ob-container-string2").style.marginTop=i+"px",document.getElementById("ob-container-string3").style.marginTop=i+"px",setTimeout(function(){document.getElementById("ob-container-string1").className="",document.getElementById("ob-container-string2").className="",document.getElementById("ob-container-string3").className="",document.getElementById("user-optionsbox").className=""},settings.reflowTime)},Terminal._hideUserBox=function(){this._isUserBoxShowing&&(this._isUserBoxShowing=!1,document.getElementById("ob-container-string1").className="off",document.getElementById("ob-container-string2").className="off",document.getElementById("ob-container-string3").className="off",document.getElementById("user-optionsbox").className="off",setTimeout(function(){document.getElementById("user-optionscontainer").className="off"},settings.userOptionsSettings.animationTime))},Terminal._switchUserBox=function(e){this._hideUserBox(),setTimeout(function(){Terminal._showUserBox(e)},settings.userOptionsSettings.animationTime)},function(){$("*:not(#user-optionscontainer>*):not(.channel-user)").click(function(){Terminal._userBoxOnWaitMode||Terminal._hideUserBox()})}(),client.hk_initialize_post=function(){document.body.style.display="none",pre_setup(),setupPage(),Terminal.openChannelWin("server",0),document.body.style.display="",setTimeout(function(){Terminal.swapChannel(0),setTimeout(function(){leftPos=$('.channels-chanitem[chanid="0"]').attr({id:"channels-selected"}).position().left,document.getElementById("channels-selector").style.left=leftPos+"px"},settings.reflowTime)},settings.reflowTime),Terminal.print_preset("loaded"),(new Event).fromObject({eventid:ECMD_STATUS}).request(function(e){return e.identification?(client.usrNick=e.nick,client.usrIdentification=e.identification,client.usrid=e.userid,Terminal.print_preset("logon"),Terminal.scrollToBottom(!0),client.initialReconnect=!0,client.longpoll()):localStorage&&localStorage.getItem("identification")?(new Event).fromObject({eventid:ECMD_IDENTIFY,id:localStorage.getItem("identification")}).request(function(e){client.usrNick=e.nick,client.usrIdentification=e.identification,client.usrid=e.userid,Terminal.print_preset("logon"),Terminal.scrollToBottom(!0),client.initialReconnect=!0,client.longpoll()}):Terminal.print_preset("loaded_loggedout"),!1})},setupPage=function(){var t,n,o,c,s,r,a;t=function(){Events.Event[ECMD_LOGIN].hooks.reqSuccess=Events.Event[ECMD_IDENTIFY].hooks.reqSuccess=function(e){Terminal.print_preset("logon"),Terminal.scrollToBottom(!0)},Events.Event[ECMD_LOGIN].hooks.reqSuccessError=Events.Event[ECMD_IDENTIFY].hooks.reqSuccessError=function(e,t){},Events.Event[ECMD_LOGOUT].hooks.reqSuccess=function(e,t){},Events.Event[ECMD_STATUS].hooks.reqSuccess=function(e,t){},Events.Event[ECMD_LEAVE].hooks.reqSuccess=function(e,t){},Events.Event[ECMD_JOIN].hooks.reqSuccess=function(e,t){},Events.Event[ECMD_MESSAGE].hooks.reqSuccess=function(e,t){},hk_server_event_append_message=function(){Terminal.print_message(this.arguments.chanid,this.arguments,!1,!1),this.arguments.old||this.arguments.userid==client.usrid||Terminal.messageNotification.message(this.arguments.chanid)},hk_server_event_prepend_message=function(){Terminal.print_message(this.arguments.chanid,this.arguments,!0,!1)},hk_server_event_append_whisper=function(){Terminal.print_message(null,this.arguments,!1,!1),this.arguments.old||this.arguments.userid==client.usrid||Terminal.messageNotification.message(this.arguments.chanid)},hk_server_event_append_log=function(e,t){Terminal.print(client.activeChanRef.chanid,t.message,t.type),Terminal.scrollToBottom(!0)},hk_server_event_add_messages_completed=function(){Terminal.scrollToBottom()},hk_server_event_from_undefined_event=function(){},hk_event_request_from_undefined_event=function(){Terminal.print(client.activeChanRef.chanid,"We're not exactly sure what you're trying to do.. ^o)","error"),Terminal.scrollToBottom()},hk_server_event_exception_thrown=function(t,n){Terminal.print(client.activeChanRef.chanid,"exception thrown: "+n.message,"error"),Terminal.scrollToBottom()},hk_event_request_exception_thrown=function(t,n){Terminal.print(client.activeChanRef.chanid,"exception thrown: "+n.message,"error"),Terminal.scrollToBottom()},hk_event_parsed_bad_format=function(){Terminal.print(client.activeChanRef.chanid,"Error parsing command: "+this.evtref.help,"error"),Terminal.scrollToBottom()},hk_event_unknown_command=function(e,t){Terminal.print(client.activeChanRef.chanid,"Unknown command (^15"+t+"^1).. ^o)","error"),Terminal.scrollToBottom()},hk_server_response_error=function(e,t){},client.hk_messagesreceived_post=function(){Terminal.scrollToBottom()},client.hk_user_joined_post=function(){Terminal._addUser(this.arguments.chanid,this.arguments.suserid,this.arguments.status,this.arguments.nick,!1)},client.hk_user_left_pre=function(){Terminal._remUser(this.arguments.chanid,this.arguments.userid)},client.hk_user_changed_post=function(){console.log(this.arguments),Terminal._changeUser(this.arguments.chanid,this.arguments.duserid,this.arguments.status)},client.hk_channel_changed_post=function(){}},n=function(){var e,t,n,i,o,c,s,r,a,l,d,m,u,p,h,g,f,_,b,E,v,C,w,y,T,B,I,A,k,S,O,N,D,M,x,W,L,R,U,q,$,H,P,F,j,G,V,K,Y,z,X,J,Q,Z,et,tt,nt,it,ot,ct,st,rt,at,lt,dt,mt,ut,pt,ht,gt,ft,_t;e=document.createDocumentFragment(),t=document.createElement("div"),n=document.createElement("div"),i=document.createElement("div"),o=document.createElement("div"),c=document.createElement("div"),s=document.getElementById("main"),r=s.cloneNode(!0),a=r.children[0],l=a.cloneNode(!0),d=document.createElement("div"),m=document.createElement("div"),u=document.createElement("div"),p=document.createElement("div"),h=document.createElement("div"),g=document.createElement("div"),f=document.createElement("div"),_=document.createElement("div"),b=document.createElement("div"),t.setAttribute("id","wrapper1"),n.setAttribute("id","wrapper2"),i.setAttribute("id","wrapper3"),o.setAttribute("id","wrapper4"),c.setAttribute("id","wrapper-console"),d.setAttribute("id","wrapper-cube"),m.setAttribute("id","console-cube"),u.setAttribute("id","console-cube-top"),p.setAttribute("id","console-cube-front"),h.setAttribute("id","console-cube-left"),g.setAttribute("id","console-cube-right"),f.setAttribute("id","console-cube-back"),_.setAttribute("id","console-cube-bottom"),b.setAttribute("id","loading-indicator"),u.className=p.className=h.className=g.className=_.className=f.className="face",p.appendChild(b),p.appendChild(l),m.appendChild(u),m.appendChild(h),m.appendChild(g),m.appendChild(f),m.appendChild(_),m.appendChild(p),d.appendChild(m),document.body.removeChild(s),r.removeChild(a),c.appendChild(d),r.insertBefore(c,r.getElementsByTagName("footer")[0]),o.appendChild(r),i.appendChild(o),n.appendChild(i),t.appendChild(n),e.appendChild(t),document.body.appendChild(e),E=document.createDocumentFragment(),v=document.createElement("header"),C=document.createElement("img"),w=document.createElement("div"),y=document.createElement("img"),T=document.createElement("img"),B=document.createElement("img"),I=document.createElement("img"),w.appendChild(y),w.appendChild(T),w.appendChild(B),w.appendChild(I),v.appendChild(C),v.appendChild(w),E.appendChild(v),document.body.insertBefore(E,document.body.childNodes[0]),A=document.createDocumentFragment(),k=document.createElement("div"),S=document.createElement("div"),O=document.createElement("div"),N=document.createElement("div"),D=document.createElement("div"),k.setAttribute("id","channel-details"),S.setAttribute("id","cd-channel-door"),O.setAttribute("id","chan-title"),N.setAttribute("id","channels"),D.setAttribute("id","channels-selector"),N.appendChild(D),k.appendChild(S),k.appendChild(O),k.appendChild(N),A.appendChild(k),document.getElementById("wrapper-console").appendChild(A),M=document.createDocumentFragment(),x=document.createElement("div"),W=document.createElement("a"),L=document.createElement("div"),R=document.createElement("div"),U=document.createElement("div"),q=document.createElement("div"),$=document.createElement("a"),H=document.createElement("img"),x.setAttribute("id","prompt-goodies"),W.setAttribute("id","gd-colours"),W.setAttribute("href","#"),L.className="gd-colours-img",R.className="gd-colours-img",U.className="gd-colours-img",q.className="gd-colours-img",L.style.background="blue",R.style.background="green",U.style.background="orange",q.style.background="yellow",$.setAttribute("id","gd-emoticons"),$.setAttribute("href","#"),H.setAttribute("src","images/emoticons/happy.gif"),W.appendChild(L),W.appendChild(R),W.appendChild(U),W.appendChild(q),x.appendChild(W),$.appendChild(H),x.appendChild($),M.appendChild(x),document.getElementById("footer").insertBefore(M,document.getElementById("fPrompt")),P=document.createDocumentFragment(),F=document.createElement("div"),j=document.createElement("div"),G=document.createElement("div"),V=document.createElement("div"),K=document.createElement("fieldset"),Y=document.createElement("div"),z=document.createElement("img"),X=document.createElement("img"),J=document.createElement("div"),Q=document.createElement("div"),Z=document.createElement("div"),et=document.createElement("legend"),tt=document.createElement("div"),nt=document.createElement("div"),it=document.createElement("a"),ot=document.createElement("img"),_rcChan_List=document.createElement("a"),_rcChan_ListImg=document.createElement("img"),F.setAttribute("id","right-container"),j.setAttribute("id","rc-section-top"),G.setAttribute("id","rc-section-midupper"),V.setAttribute("id","rc-section-midlower"),K.setAttribute("id","rc-section-bottom"),Y.setAttribute("id","rc-section-bottomlogo"),X.setAttribute("id","rc-logo"),z.setAttribute("id","rc-logoruby"),J.setAttribute("id","rc-details"),Q.setAttribute("id","rc-chanoptions"),et.setAttribute("id","rc-details-channame"),Z.setAttribute("id","rc-userlist"),X.setAttribute("src","images/logo-2.png"),z.setAttribute("src","images/ruby2.png"),tt.setAttribute("id","rc-details-server"),nt.setAttribute("id","rc-details-ping"),it.setAttribute("id","rc-chan-leave"),it.setAttribute("href","#"),ot.setAttribute("src","images/icon-leave.png"),_rcChan_List.setAttribute("id","rc-chan-list"),_rcChan_List.setAttribute("href","#"),_rcChan_ListImg.setAttribute("src","images/icon-list.png"),tt.innerHTML="Server: "+location.hostname,J.appendChild(tt),J.appendChild(nt),it.appendChild(ot),_rcChan_List.appendChild(_rcChan_ListImg),Q.appendChild(it),Q.appendChild(_rcChan_List),j.appendChild(X),G.appendChild(J),V.appendChild(Q),K.appendChild(et),K.appendChild(Z),Y.appendChild(z),F.appendChild(j),F.appendChild(G),F.appendChild(V),F.appendChild(K),F.appendChild(Y),P.appendChild(F),document.getElementById("wrapper-console").insertBefore(P,document.getElementById("consosole")),ct=document.createDocumentFragment(),st=document.createElement("div"),rt=document.createElement("div"),at=document.createElement("div"),lt=document.createElement("div"),dt=document.createElement("div"),mt=document.createElement("div"),ut=document.createElement("div"),pt=document.createElement("div"),_obString1i=document.createElement("div"),_obString2i=document.createElement("div"),_obString3i=document.createElement("div"),_cbOption_Whois=document.createElement("a"),_cbOption_Kick=document.createElement("a"),_cbOption_Ban=document.createElement("a"),_cbOption_Voice=document.createElement("a"),_cbOption_Chanop=document.createElement("a"),_cbOption_Stripop=document.createElement("a"),st.setAttribute("id","user-optionscontainer"),rt.setAttribute("id","user-optionsbox"),at.setAttribute("id","ob-container-string1"),lt.setAttribute("id","ob-container-string2"),dt.setAttribute("id","ob-container-string3"),mt.setAttribute("id","ob-string1"),ut.setAttribute("id","ob-string2"),pt.setAttribute("id","ob-string3"),_obString1i.setAttribute("id","ob-string1i"),_obString2i.setAttribute("id","ob-string2i"),_obString3i.setAttribute("id","ob-string3i"),_cbOption_Whois.setAttribute("id","ob-option-whois"),_cbOption_Kick.setAttribute("id","ob-option-kick"),_cbOption_Ban.setAttribute("id","ob-option-ban"),_cbOption_Voice.setAttribute("id","ob-option-voice"),_cbOption_Chanop.setAttribute("id","ob-option-chanop"),_cbOption_Stripop.setAttribute("id","ob-option-stripop"),st.className="off",rt.className="off",at.className="off",lt.className="off",dt.className="off",_cbOption_Whois.setAttribute("href","#"),_cbOption_Kick.setAttribute("href","#"),_cbOption_Ban.setAttribute("href","#"),_cbOption_Voice.setAttribute("href","#"),_cbOption_Chanop.setAttribute("href","#"),_cbOption_Stripop.setAttribute("href","#"),_cbOption_Whois.className="user-option",_cbOption_Kick.className="user-option powermode-operator",_cbOption_Ban.className="user-option powermode-operator",_cbOption_Voice.className="user-option powermode-operator",_cbOption_Chanop.className="user-option powermode-operator",_cbOption_Stripop.className="user-option powermode-operator",_cbOption_Whois.innerHTML="Who Are You",_cbOption_Kick.innerHTML="Kick User",_cbOption_Ban.innerHTML="Ban User",_cbOption_Voice.innerHTML="Give Voice Status",_cbOption_Chanop.innerHTML="Give Channel Operator Status",_cbOption_Stripop.innerHTML="Strip User Status",rt.appendChild(_cbOption_Whois),rt.appendChild(_cbOption_Kick),rt.appendChild(_cbOption_Ban),rt.appendChild(_cbOption_Voice),rt.appendChild(_cbOption_Chanop),rt.appendChild(_cbOption_Stripop),at.appendChild(mt),lt.appendChild(ut),dt.appendChild(pt),at.appendChild(_obString1i),lt.appendChild(_obString2i),dt.appendChild(_obString3i),st.appendChild(rt),st.appendChild(at),st.appendChild(lt),st.appendChild(dt),ct.appendChild(st),document.body.appendChild(ct),ht=document.createDocumentFragment(),gt=document.createElement("div"),gt.setAttribute("id","cw-colours-container"),gt.style.display="none",ht.appendChild(gt),document.getElementById("wrapper4").appendChild(ht),ft=document.createDocumentFragment(),_t=document.createElement("div"),_t.setAttribute("id","ew-emoticons-container"),_t.style.display="none",ft.appendChild(_t),document.getElementById("wrapper4").appendChild(ft)},o=function(){var e,t,n;e=document.createDocumentFragment(),t=document.createElement("link"),TESTING_MODE==1?(t.setAttribute("rel","stylesheet/less"),t.setAttribute("type","text/css"),t.setAttribute("href","styles/desktop.less"),e.appendChild(t),n=document.createElement("script"),n.setAttribute("src","js/less-1.3.0.min.js"),e.appendChild(n)):(t.setAttribute("rel","stylesheet"),t.setAttribute("type","text/css"),t.setAttribute("href","styles/desktop.css"),e.appendChild(t)),document.getElementsByTagName("head").item(0).appendChild(e)},c=function(){var e,t,n;document.getElementById("ob-option-whois").onclick=function(){return(new Event).fromObject({eventid:ECMD_WHOIS,nick:Terminal._userSelected.nick}).request(),!1},document.getElementById("ob-option-kick").onclick=function(){return(new Event).fromObject({eventid:ECMD_KICK,chanid:client.activeChanRef.chanid,kickid:Terminal._userSelected.nick,reason:"meh"}).request(),!1},document.getElementById("ob-option-ban").onclick=function(){return(new Event).fromObject({eventid:ECMD_BAN,chanid:client.activeChanRef.chanid,username:Terminal._userSelected.nick}).request(),!1},document.getElementById("ob-option-voice").onclick=function(){return(new Event).fromObject({eventid:ECMD_CHANOP,chanid:client.activeChanRef.chanid,opid:Terminal._userSelected.nick,optype:"1"}).request(),!1},document.getElementById("ob-option-chanop").onclick=function(){return(new Event).fromObject({eventid:ECMD_CHANOP,chanid:client.activeChanRef.chanid,opid:Terminal._userSelected.nick,optype:"0"}).request(),!1},document.getElementById("ob-option-stripop").onclick=function(){return(new Event).fromObject({eventid:ECMD_CHANOP,chanid:client.activeChanRef.chanid,opid:Terminal._userSelected.nick,optype:"2"}).request(),!1},document.getElementById("rc-chan-leave").onclick=function(){return(new Event).fromObject({eventid:ECMD_LEAVE,chanid:client.activeChanRef.chanid}).request(),!1},document.getElementById("rc-chan-list").onclick=function(){var e=new Event;return e.fromObject({eventid:ECMD_LIST}).request(function(t){var n,i="^13CHANNEL LIST\\n      ";for(n in t.channels)i+="^8#"+t.channels[n].name+" ^1(^0"+t.channels[n].users+"^1)"+(t.channels[n].topic?" - ^11"+t.channels[n].topic:"")+"\\n      ";client.handle_evtMessage.call(e,{type:"",data:"",message:i})}),!1},function(){var e=document.getElementById("console-cube-front"),t=0,n=document.getElementById("loading-indicator");$(document.getElementById("console-cube-front")).scroll(function(){if(client.activeChanRef.chanid!=0&&client.activeChanRef._reachedEnd!=1){var i=e.scrollHeight,o=client.activeChanRef.chanid;e.scrollTop>t||(n.style.visibility="visible",Terminal.loadOlder.load(function(t){n.style.visibility="hidden",t.end!=1?client.activeChanRef.chanid==o&&(e.scrollTop=e.scrollHeight-i):client.channels[o]._reachedEnd=!0}))}})}(),function(){var e,t,n,i,o,c,s,r,a,l,d;return settings.pingEnabled?(e=document.getElementById("rc-details-ping"),t=document.getElementById("rc-details"),n=function(e){return e>90?e>150?e>250?e>500?e>800?0:1:2:3:4:5},i=0,o=settings.minPingTimeoutsToDisconnect,c=null,s=null,r=function(){},a=function(){},l=Events.Event.ECMD_LOGIN.hooks.reqSuccess,Events.Event.ECMD_LOGIN.hooks.reqSuccess=function(e){l(e),c=(new Date).getTime()},l=Events.Event.ECMD_JOIN.hooks.reqSuccess,Events.Event.ECMD_JOIN.hooks.reqSuccess=function(e){l(e);var t=getChanCount();t==2&&(c=(new Date).getTime())},r=function(){window.console.log("DISCONNECTING USER.. from: "+arguments.callee.caller.name),(new Event).fromObject({eventid:ECMD_LOGOUT}).request(),s=null},a=function(){var e,t;if(client.usrid==null||Terminal._disconnected||s==null||getChanCount()<2){e=s,s=null;for(t in client.channels)if(t!=null){s=e;break}}else(new Date).getTime()-s>settings.maxTimeSinceLastPingToDisconnect&&c!=null&&(new Date).getTime()-c>settings.maxTimeSinceLastPingToDisconnect&&(window.console.log("=================================="),window.console.log("D/C!  time:"+(new Date).getTime()+"-"+s+">"+settings.maxTimeSinceLastPingToDisconnect),r(),window.console.log("=================================="));setTimeout(a,settings.checkIfActiveTimer)},a(),pingSuccess=function(o){Terminal._disconnected==1&&(Terminal._disconnected=!1,$("body").removeClass("disconnected"),$("#prompt").attr({disabled:!1})),i=0,t.style.display="none",e.innerHTML="Ping: "+o+"ms",e.setAttribute("connection-level",n(o)),t.style.display=""},pingFail=function(){i++,o>i||(Terminal._disconnected=!0,$("body").addClass("disconnected")),t.style.display="none",e.innerHTML="x",e.setAttribute("connection-level","0"),t.style.display=""},settings.useLongpollPing?(client.hk_longpoll_success=function(e){var t=e.timeReceived-d;10>e.totalTime||(console.log("============hk_longpoll_success==========="),console.log(e),console.log("==========================================")),pingSuccess(parseInt(t))},client.hk_longpoll_error=function(e){pingFail()},client.hk_longpoll_post=function(){d=Date.now()+"",d=d.substr(0,d.length-3)+"."+d.substr(d.length-3),d=parseFloat(d),s=(new Date).getTime()}):(Events.Event[ECMD_PINGCHAN].hooks.reqSuccess=function(e,t){pingSuccess(t),s=(new Date).getTime()},Events.Event[ECMD_PINGCHAN].hooks.reqSuccessError=function(e,t){pingFail(),s=(new Date).getTime()}),void 0):!1}(),function(){if(settings.windowResizeSettings.enabled==0)return null;var e=window.screenX,t=window.screenY,n=settings.windowResizeSettings.interval,i=function(){(window.screenX!=e||window.screenY!=t)&&(0>window.screenX?(document.body.style.display="none",document.getElementById("wrapper2").style.left=-window.screenX+"px",document.getElementById("wrapper2").style.right="0px",document.getElementById("wrapper2").style.width="auto",document.getElementById("wrapper4").style.margin="0",document.body.style.display=""):0>e&&(document.body.style.display="none",document.getElementById("wrapper2").style.left="",document.getElementById("wrapper2").style.right="",document.getElementById("wrapper2").style.width="",document.getElementById("wrapper4").style.margin="",document.body.style.display=""),e=window.screenX,t=window.screenY),setTimeout(i,n)};setTimeout(i,n)}(),e=function(){var e,t,n,i,o,c;t=document.getElementById("cw-colours-container"),n=document.createDocumentFragment(),i=settings.colourMap,o={showWindow:null,hideWindow:null,triggerWindow:null,_windowShowing:!1};for(e in i)c=document.createElement("a"),c.style.background=i[e],c.setAttribute("href","#"),c.details={colour:i[e],index:e},c.onclick=function(){var e=document.getElementById("prompt"),t=e.selectionStart,n=e.value,i="^"+this.details.index;return isNaN(t)?n+=i:n=n.substr(0,t)+i+n.substr(t),e.value=n,o.hideWindow(),!1},n.appendChild(c);return t.appendChild(n),o.showWindow=function(){setTimeout(function(){t.style.display="block",o._windowShowing=!0},50)},o.hideWindow=function(){t.style.display="none",o._windowShowing=!1},o.triggerWindow=function(){o._windowShowing?o.hideWindow():o.showWindow()},o}(),Terminal.colourWin=e,document.getElementById("gd-colours").onclick=function(){return e.triggerWindow(),!1},t=function(){var e,t,n,i,o,c,s,r;t=document.getElementById("ew-emoticons-container"),n=document.createDocumentFragment(),i=settings.emoticonMap,o={showWindow:null,hideWindow:null,triggerWindow:null,_windowShowing:!1};for(e in i)c=document.createElement("a"),s=document.createElement("img"),r=e,r=r.replace(/\\:/g,":").replace(/\\;/g,";").replace(/\\@/g,"@").replace(/\\\(/g,"(").replace(/\\\)/g,")").replace(/\\\[/g,"[").replace(/\\\]/g,"]").replace(/\\{/g,"{").replace(/\\}/g,"}").replace(/\\\\/g,"\\").replace(/\\\//g,"/").replace(/\\=/g,"=").replace(/\\\'/g,"'").replace(/\\\"/g,'"').replace(/\\\+/g,"+").replace(/\\\^/g,"^").replace(/\\\*/g,"*"),s.setAttribute("src","images/emoticons/"+i[e]),c.setAttribute("href","#"),c.details={emoticon:i[e],index:r},c.onclick=function(){var e=document.getElementById("prompt"),t=e.selectionStart,n=e.value,i=this.details.index;return isNaN(t)?n+=i:n=n.substr(0,t)+i+n.substr(t),e.value=n,o.hideWindow(),!1},c.appendChild(s),n.appendChild(c);return t.appendChild(n),o.showWindow=function(){setTimeout(function(){t.style.display="block",o._windowShowing=!0},50)},o.hideWindow=function(){t.style.display="none",o._windowShowing=!1},o.triggerWindow=function(){o._windowShowing?o.hideWindow():o.showWindow()},o}(),Terminal.emoticonsWin=t,document.getElementById("gd-emoticons").onclick=function(){return t.triggerWindow(),!1},$("*").click(function(){Terminal.emoticonsWin.hideWindow(),Terminal.colourWin.hideWindow(),document.getElementById("prompt").focus()}),n=function(){var e,t,n={off:function(){},on:function(){},notify:function(){},stopNotify:function(){},message:function(){},openChan:function(){},dbg:function(){}},o={sounds:!0,message:!0,flashOnTime:1e3,flashOffTime:1e3,flashMessage:"New Message Notification",flashChannelColour:"green",beepSound:"beep.wav"},c=new Audio(o.beepSound),s=[],r=!1,a=!0;return c.load(),typeof localStorage=="object"&&(localStorage.getItem("notification-sound")&&(o.sounds=localStorage.getItem("notification-sound")),localStorage.getItem("notification-message")&&(o.message=localStorage.getItem("notification-message"))),t=function(){return typeof localStorage=="object"?function(){localStorage.setItem("notification-sound",o.sounds),localStorage.setItem("notification-message",o.message)}:function(){}}(),n.dbg=function(){console.log("DEBUG"),console.log(o),console.log(s),console.log("notifying: "+r),console.log("focus: "+a)},n.off=function(){o.sounds=!1,o.message=!1,t()},n.on=function(){o.sounds=!0,o.message=!0,t()},n.notify=function(){c.play(),r||(r=!0,e=window.document.title,function(){var t=function(){if(r){window.document.title=o.flashMessage,setTimeout(n,o.flashOnTime);for(var e=0;s.length>e;e++)$('.channels-chanitem[chanid="'+s[e]+'"]')[0].style.background=o.flashChannelColour}},n=function(){if(r){window.document.title=e,setTimeout(t,o.flashOffTime);for(var n=0;s.length>n;n++)$('.channels-chanitem[chanid="'+s[n]+'"]')[0].style.background=""}};t()}())},n.stopNotify=function(){r=!1,window.document.title=e;for(var t=0;s.length>t;t++)$('.channels-chanitem[chanid="'+s[t]+'"]')[0].style.background=""},n.message=function(e){if(!a||e!=client.activeChanRef.chanid){for(var t=0;s.length>t;t++)if(parseInt(s[t])==e)return n.notify(),void 0;s.push(e),n.notify()}},n.openChan=function(e){var t,i=-1;for(t=0;s.length>t;t++)if(parseInt(s[t])==e){i=t;break}i>-1&&($('.channels-chanitem[chanid="'+s[i]+'"]')[0].style.background="",s.splice(i,1)),s.length==0&&n.stopNotify()},window.addEventListener("focus",function(){a=!0,n.openChan(client.activeChanRef.chanid)}),window.addEventListener("blur",function(){a=!1}),e=window.document.title,n}(),Terminal.messageNotification=n},s=function(){},r=function(){document.getElementById("rc-section-bottom").oncontextmenu=function(){return!1},document.getElementById("user-optionscontainer").oncontextmenu=function(){return!1},document.getElementById("prompt").setAttribute("placeholder",settings._promptPlaceholder)},a=function(){$("#fPrompt").submit(function(){var e,t,n,i;return e=new Date,client._tMessageCreated=e.getTime(),t=$("#prompt").val(),$("#prompt").val(""),t==""?!1:(n=new Event,i=n.parse(t),i&&i.request(),!1)});var e=settings.message_maxlen;$("#prompt").keyup(function(){var t=$("#prompt").val(),n=t.replace(/(\\|'|")/g,function(e){return"\\"+e});n.length>e?$(this).val($(this).attr("safeguard")):$(this).attr("safeguard",t)})},t(),n(),o(),c(),r(),s(),a()},client.initialize()